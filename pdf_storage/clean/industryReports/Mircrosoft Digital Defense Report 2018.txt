MICROSOFT SECURITY INTELLIGENCE REPORT VOLUME 24 JANUARY – DECEMBER 2018 Table of contents 1 This document is for informational purposes only. MICROSOFT MAKES NO WARRANTIES, EXPRESS, IMPLIED, OR STATUTORY, AS TO THE INFORMATION IN THIS DOCUMENT. This document is provided “as-is.” Information and views expressed in this document, including URL and other Internet Web site references, may change without notice. You bear the risk of using it. Copyright © 2019 Microsoft Corporation. All rights reserved. The names of actual companies and products mentioned herein may be the trademarks of their respective owners. 2 Authors and contributors Abhishek Agrawal Jonathan Trull Pragya Pandey Information Protection Cybersecurity Solutions Group Microsoft Security Marketing David Fantham Joram Borenstein Ram Pliskin Information Protection Cybersecurity Solutions Group Azure Security Debraj Ghosh Karthik Selvaraj Ryan McGee Microsoft Security Marketing Windows Defender Research Team Microsoft Security Marketing Diana Kelley Kasia Kaplinska Seema Kathuria Cybersecurity Solutions Group Microsoft Security Marketing Cybersecurity Solutions Group Elia Florio Kristina Laidler Steve Wacker Windows Active Defense Security Incident Response Wadeware LLC Eric Avena Matt Duncan Tanmay Ganacharya Windows Defender Research Team Windows Active Defense Data Engineering and Analytic Windows Defender Research Team Eric Douglas Mark Simos Volv Grebennikov Windows Defender Research Team Cybersecurity Solutions Group Bing Francis Tan Seng Paul Henry Yaniv Zohar Windows Defender Research Team Wadeware LLC Azure Security AUTHORS AND CONTRIBUTORS 3 Foreword Hello and welcome to the 24th edition of the Microsoft Security Intelligence Report (SIR). As a practitioner and security architect, I read reports like this hoping to understand the landscape a little better with the takeaway of practical advice about how to use that knowledge to defend and protect organizations more effectively. The SIR team brings the spirit of education for improved cyber-resilience to this report and has sifted through a year of data to distill out the most important lessons. What you’re reading are insights culled from a year of security data analysis and hands-on lessons learned. Data analyzed includes the 6.5 trillion threat signals that go through the Microsoft cloud every day and the research and real- world experiences from our thousands of security researchers and responders around the world. In 2018, attackers used a variety of dirty tricks, both new (coin-mining) and old (phishing), in their ongoing quest to steal data and resources from customers and organizations. Hybrid attacks, like the Ursnif campaign, blended social and technical approaches. As defenders got smarter against ransomware, a loud and disruptive form of attack, criminals pivoted to the more “stealth”, but still profitable, coin-miners. That “pivot” can feel frustrating, like attackers are always one step ahead. But viewed through a different lens, the story here is a positive one. Defenders and cybersecurity professionals like you implemented defensive techniques that forced attackers to change their preferred payloads and move away from ransomware. Another area where cyber criminals increased their activity is the supply chain. One of the most notable, the Dofoil coin-miner outbreak, which hit on March 6, 2018, was kicked off by a poisoned peer-to-peer app. Supply chain concerns went beyond apps and into the cloud and included malicious browser extensions, compromised Linux repositories, and multiple instances of back-doored modules. To address this threat, organizations are moving towards a transparent and trusted supply chain model. FOREWORD 4 Data is great, but sometimes it helps to find out what really happened at an organization. That’s why we’ve included lessons learned in the field from our Detection and Response Team (DART). These include how a large manufacturing company was able to implement controls to block a multi-phased phishing campaign that had been plaguing them for months, and financial services organizations that were finally able to eradicate threat actors from their systems using advanced investigation tools and endpoint monitoring. Last but not least, phishing clicks continued to go up – but machine learning models are getting better at catching phish before they hit user boxes and preventing harm after click if they do. More good news? An increasing number of companies are implementing multi-factor solutions to limit the success of credential theft phishing emails. Attackers look for opportunities, so the more we know about their techniques and tradecraft, the better prepared we’ll be to build defenses and respond quickly. Small important steps can make a huge difference in the overall cybersecurity health of an organization. That’s why along with deep insights on the shifting malware and attack landscape, you’ll find recommended steps and other best practice guidance in this report. Because when I was a practitioner that’s exactly what I needed in my fight against the bad guys. We hope it’s what you need too. Diana Kelley Microsoft Cybersecurity Field CTO P.S. We’re always looking to improve the SIR. If you’ve got feedback, please reach out and let us know how we’re doing. FOREWORD 5 SECTION I Ransomware, cryptocurrency mining, and money The big security stories of 2017 mostly involved ransomware. High-profile worldwide outbreaks of WannaCrypt and Petya thrust ransomware —a type of malware that locks or encrypts computers, then demands money to restore access—into the general consciousness, and many speculated that the problem would only increase in the future. Instead, ransomware encounters declined significantly in 2018. The decline in ransomware encounters was due in part to improved detection and education that made it more difficult for attackers to profit from it. As a result, attackers began to shift their efforts away from ransomware to approaches such as cryptocurrency mining, which uses victims’ computing resources to make digital money for the attackers. The shift demonstrates the fundamentally opportunistic nature of most profit-oriented cybercriminals: they tend to chase the easiest money available, and when the economics of cybercrime change, they are quick to follow along. RANSOMWARE ATTACKS ON THE DECLINE More than a decade ago, the hackers and pranksters of computers even after the ransom is paid). As who dominated the early malware underground ransomware was peaking in 2017, it looked as though were supplanted by organized crime and other profit- this style of open attack might represent a new phase in oriented interests. Whereas early malware outbreaks attacker techniques. But more recent data suggests that were often flashy and obvious, profit-oriented malware ransomware might be on the decline, with attackers was much more likely to operate quietly and avoid increasingly returning to the stealthier mode of attracting attention, in order to continue performing its operation they’ve employed in the past, seeking to stay function—sending spam, stealing sensitive information, under the radar in order to more effectively conduct conducting denial-of-service attacks, and other attacks like cryptocurrency mining. Although there has malicious activity—as long as possible. been a decline in the rate of ransomware encounters, this doesn’t necessarily mean that the severity of Ransomware bucked this trend. Instead of trying attacks has declined. to remain undetected, ransomware openly denies victims access to their computers and important files until the victim pays the ransom (and often even afterward; attackers often do not release their control SECTION I 7 Ransomware Encounter Rate JAN 2018 0.11% 0.12% 0.10% DEC 2017 FEB 2018 0.06% 0.07% 0.08% 0.06% DEC 2018 0.03% 0.04% 0.02% 0% MAR MAY JUL SEPT NOV JAN MAR MAY JUL SEPT NOV 2017 2018 Ransomware encounter rates declined approximately 60 percent between March FIGURE 1. 2017 and December 2018, with intermittent increases across that period. Ransomware encounters from March 2017 t o December 2018 There are probably many causes for this overall decline, although Microsoft security researchers suspect that a primary factor is that both end users and organizations are becoming more aware of and dealing more intelligently with ransomware threats, including exerting greater caution and backing up important files so they can be restored if encrypted by ransomware. Also, as described earlier, cybercriminals are opportunistic. SECTION I 8 FIGURE 2. Average monthly ransomware encounter rates worldwide by country/region in 2018 COUNTRY MOST IMPACTED BY RANSOMWARE: ETHIOPIA AVERAGE MONTHLY RANSOMWARE ENCOUNTER RATE, 2018 0.20% + 0.15% to 0.20% 0.10% to 0.150% 0.05% to 0.10% > 0 to 0.05% Insufficient data 0.77% Average monthly encounter rate: Worldwide: 0.05% http://www.microsoft.com/sir The five locations with the highest average monthly ransomware encounter rates in 2018 were Ethiopia (0.77 percent average monthly ransomware encounter rate), Mongolia (0.46), Cameroon (0.41), Myanmar (0.33), and Venezuela (0.31), each of which had an average monthly ransomware encounter rate of 0.31 percent or higher during the period.1 A few years ago, ransomware encounters tended to cluster in wealthy countries and regions in Europe and North America, but as ransomware has started to fall out of favor with attackers the encounter pattern has come to more closely resemble that of malware as a whole. The locations with the lowest ransomware encounter rates in 2018 were Ireland (0.01), Japan (0.01), the United States (0.02), United Kingdom (0.02), and Sweden (0.02 percent), each of which had an average monthly ransomware encounter rate of 0.02 percent or lower during the same period. Locations with low encounter rates tend to have mature FOOTNOTES ¹ Encounter rate is the percentage of cybersecurity infrastructures and well-established programs for protecting critical infrastructure and communicating computers running Microsoft real-time with their citizens about basic security. security products that report a malware encounter. Encountering a threat does not mean the computer has been infected. Only computers whose users have opted in to provide data to Microsoft are considered when calculating encounter rates. SECTION I 9 CRYPTOCURRENCY MINING ON THE RISE Cryptocurrency is virtual money that can be used to In 2018, the average worldwide monthly cryptocurrency AVERAGE MONTHLY ENCOUNTER RATES anonymously buy and sell goods and services, both coin mining encounter rate was 0.12 percent, compared OF COUNTRIES MOST IMPACTED BY CRYPTOCURRENCY MINING online and in the physical world. Many different kinds to just 0.05 percent for ransomware. Many factors of cryptocurrencies exist, but they are all based on contribute to the increased popularity of mining blockchain technology, in which every transaction as a payload for malware. Unlike ransomware, is recorded in a distributed ledger maintained by cryptocurrency mining does not require user input: it thousands or millions of computers around the world. works in the background, while the user is performing New coins are created, or “mined,” by computers other tasks or is away from the computer, and may performing complex calculations that also serve the not be noticed at all unless it degrades the computer’s function of verifying blockchain transactions. performance sufficiently. As a result, users are less likely to take any action to remove the threat, and it might 5.58% Ethiopia: Mining coins can be very lucrative—in 2018, a continue mining for the benefit of the attacker for an single coin of Bitcoin, the oldest and most popular extended period of time. cryptocurrency, was worth several thousand US dollars—but performing the necessary calculations The availability of “off the shelf” products for covert can be very resource intensive and becomes more so mining of many cryptocurrencies is another driver as each new coin is mined. For popular currencies such of the trend. The barrier to entry is low because of as Bitcoin, mining coins profitably is almost impossible the wide availability of coin mining software, which without access to immense computing resources that cybercriminals repackage as malware to deliver to are well out of reach for most individuals and small unsuspecting users’ computers. The weaponized miners 1.83% Tanzania: groups. For this reason, attackers seeking illicit profits are then distributed to victims using many of the same have increasingly turned to malware that lets them use techniques attackers use to deliver other threats, such victims’ computers to help them mine cryptocurrency as social engineering, exploits, and drive-by downloads. coins. This approach allows them to leverage the After the mining software is installed, it runs in the processing power of hundreds of thousands of background on victim’s computers to perform the computers instead of one or two. Even when a minor blockchain computations, with the attacker reaping the infection is discovered, the anonymous nature of rewards. cryptocurrency complicates efforts to track down the 1.47% responsible parties. Pakistan: SECTION I 10 FIGURE 3. Average monthly coin miner encounter rates worldwide by country/region in 2018 AVERAGE MONTHLY ENCOUNTER RATES OF COUNTRIES LEAST IMPACTED BY CRYPTOCURRENCY MINING AVERAGE MONTHLY COIN MINING ENCOUNTER RATE, 2018 0.80% + 0.60% to 0.80% 0.40% to 0.60% 0.20% to 0.40% > 0 to 0.20% 0.02% Insufficient data Ireland: Worldwide: 0.12% http://www.microsoft.com/sir The five locations with the highest cryptocurrency coin mining encounter rates in 2018 were Ethiopia (5.58), Tanzania (1.83), Pakistan (1.47), Kazakhstan (1.24), and Zambia (1.13), each of which had an average monthly coin mining encounter rate of approximately 1.13 percent or higher during the period. The locations with the lowest coin mining encounter rates in 2018 were Ireland, Japan, the United States, and China, each of which had an average monthly coin mining encounter rate of approximately 0.02 percent during the period. 0.02% Japan: BROWSER-BASED CRYPTOCURRENCY MINERS: A NEW KIND OF THREAT The statistics presented in this section involve malicious cryptocurrency miners that are designed to be installed on victims’ computers as malware. But some of the most significant cryptocurrency mining threats are based entirely within web browsers and never need to be installed at all. A number of services advertise browser-based cryptocurrency mining as a way for website owners to monetize traffic to their sites without relying on advertising. Site owners are supposed to add JavaScript code to their pages that mine cryptocurrency in the background while a user is visiting 0.02% the site, with the proceeds split between the site owner and the service. Unfortunately, attackers have been quick United States: to take advantage of these services to mine cryptocurrency without obtaining consent from the end users, often by SECTION I 11 Brocoiner Encounter Rate FIGURE 4. Encounter rate for Brocoiner, the most prevalent browser-based cryptocurrency DEC 2017 0.80% miner 0.69% 0.70% THE IMPACT OF UNSOLICITED CRYPTOCURRENCY MINING 0.60% The most obvious threat victims face MAY 2018 from malicious cryptocurrency mining 0.50% 0.42% is consumption of computing resources, which can waste electricity and significantly degrade computer performance. Users and 0.40% organizations also face other risks from coin mining, including: 0.30% Gaining a foothold to do greater JAN 2018 0.12% damage in the future. Like other forms of malware, 0.20% cryptocurrency mining can be an entry point for attackers. While the computer is mining cryptocurrency in the 0.10% background, cybercriminals can learn about the environment and possibly uncover gaps in security to exploit for 0% other purposes. OCT DEC FEB APR JUN AUG OCT DEC Internet-connected devices may be 2017 2018 compromised and turned into bots for cryptocurrency mining. Many such devices lack built-in security such as malware threat detection, compromising legitimate websites and maliciously inserting the mining code into their source code. These browser- which can make them desirable targets for attackers. based miners don’t require compromising the end user’s computer at all, and will run on any platform with a JavaScript- capable web browser. Like cryptocurrency mining trojans, browser-based miners can significantly degrade computer Harming machines. performance and waste electricity while a user visits an affected web page. Cryptocurrency mining software running continuously for months or longer can impair performance, and the heat generated by excessive power consumption and CPU utilization can damage computers. SECTION I 12 SECTION II Software supply chains at risk For years Microsoft has been tracking threat actors who use supply chain compromise as an entry point for attacks. In a supply chain attack, the attacker concentrates on compromising the development or update process of a legitimate software publisher. If successful, the attacker can incorporate a compromised component into a legitimate application or update package that then gets distributed to the software’s users. The malicious code then runs with the same trust and permissions as the software. The increased number of software supply chain attacks over the past few years has become an important topic in many cybersecurity conversations and is a primary source of concern in many IT departments. 2017 MAR JUN SEPT 2018 MAR AUG Ask Partner Petya ransomware CCleaner Dofoil campaign Compromised Network (APN) outbreak compromised remote support compromised program MAY JUL OCT JUL OCT 2 incidents: ShadowPad Compromised Compromised Compromised Operation backdoor media app for supply chain within hosting control WilySupply & macOS a supply chain panel compromised DVD app for macOS MAJOR SOFTWARE SUPPLY CHAIN ATTACKS IN 2017 FIGURE 5. Software supply chain attacks in 2017 and In 2017, supply chain attacks were responsible for a number of high-profile incidents, most notably the Petya 2018 ransomware outbreak in June, which was traced to initial infections from a compromised update process for a popular tax accounting application in Ukraine. In May, Operation WilySupply compromised a text editor’s software updater to install a backdoor on target organizations in the financial and IT sectors. In July, a backdoor called ShadowPad was hidden in a server management software package, and allowed attackers to install additional malware payloads for data theft and other malicious activities. In September, the infrastructure of popular freeware tool CCleaner was compromised and a backdoored version was delivered to its userbase. SECTION II 14 SOFTWARE SUPPLY CHAIN ATTACKS IN 2018 – ROOT CAUSES AND IMPACT The first major software supply chain attack incident of 2018 occurred on March 6, when Windows Defender ATP blocked a massive campaign to deliver the Dofoil trojan (also known as Smoke Loader). The massive malware campaign was traced to a poisoned peer-to-peer application. The application’s update package was replaced with a malicious one that downloaded FIGURE 6. compromised code, which later installed the Dofoil malware. The sophisticated trojan carried a coin mining payload, and Trending of Dofoil (Smoke Loader) exhibited advanced cross-process injection techniques, persistence mechanisms, and evasion methods. encounters in 2018 shows spike of blocked instances in March Dofoil Encounter Rate MAR 2018 0.26% 0.30% 0.25% 0.20% 0.15% 0.10% FEB 2018 0.02% APR 2018 DEC 2018 0.01% 0.00% 0.05% 0.00% MAR MAY JUL SEPT NOV JAN MAR MAY JUL SEPT NOV 2017 2018 In the first 12 hours of the campaign, Windows Defender Antivirus blocked more than 400,000 infection attempts worldwide. Russia accounted for 73 percent of global encounters, with Turkey and Ukraine registering 18 percent and 4 percent, respectively. SECTION II 15 Several more attacks were detected using compromised software supply chains as delivery mechanisms in 2018, including those described in the following table: FIGURE 7. Period Attack Description Software affected March Dofoil coin mining campaign Attackers poisoned the update process of a peer-to- Peer-to-peer app. Other software supply chain attacks in 2018 2018 (reported by Microsoft). peer app to install Dofoil, which in turn installed coin mining malware. July Compromised supply chain Attackers compromised the shared infrastructure PDF editor app and 2018 within a supply chain (reported by between a PDF editor app vendor and one of its third-party partner Microsoft). software vendor partners. vendor. August Compromised remote support The update server of a remote support solutions Remote support 2018 program (Operation Red provider was compromised to deliver a remote access program. Signature, reported by Trend tool called 9002 RAT. Micro and IssueMakersLab). October Compromised hosting control The installation script for a hosting control panel Hosting control panel 2018 panel solution (reported by ESET). solution was altered to steal credentials. solution. TRUST AT RISK Supply chain attacks are insidious because they take Supply chain attacks have affected a wide range of advantage of the trust that users and IT departments software and targeted organizations in different sectors place in the software they use. The compromised and geographic locations. The threat of supply chain software is often signed and certified by the vendor, attacks is an industry-wide problem that requires and may give no indication that anything is wrong, attention from multiple stakeholders, including the which makes it significantly more difficult to detect the software developers and vendors who write the code, infection. They can damage the relationship between the system administrators who manage software supply chains and their customers, whether the latter installations, and the information security community are corporate or home users. By poisoning software and that finds these attacks and creates solutions to protect undermining delivery or update infrastructures, supply people and software from them. chain attacks can affect the integrity and security of goods and services that organizations provide. SECTION II 16 BEYOND SOFTWARE: SUPPLY CHAIN COMPROMISE THROUGH CLOUD OBJECTS The ability of supply chain attacks to undermine trust is • Multiple incidents of backdoored npm modules amplified and made even more complex in the cloud. (The npm Blog, Medium) which, if exploited, could Several incidents of compromised cloud objects, services, result in situations such as, for example, an attacker and infrastructure in 2018 highlight this complexity: being able to input arbitrary code into a running server and execute it. • Poisoned Chrome extensions that installed click- fraud malware (reported by ICEBRG) These incidents demonstrate how supply chain compromise can immensely widen an attack surface. • Various compromised Linux repositories (reported If not secured, cloud objects can be unexpected entry in a few online forums) vectors. For example, the Docker Hub incident involved a malicious account uploading Docker images that • Malicious WordPress plug-ins used for various contained a hidden coin mining backdoor. The Docker malicious activities, including allowing attackers to images were hosted on Docker Hub for almost a year publish content on WordPress sites (reported by and were downloaded millions of times and used by Wordfence) unsuspecting administrators and users. • Malicious Docker images that contained a script Supply chain risks extend to code in the cloud, open to download cryptocurrency coin mining malware source, web libraries, containers, and other objects in and uploaded to Docker Hub account (reported by the cloud. These risks, coupled with the high degree Fortinet and Kromtech) of variation among the software and hardware supply chain compromise incidents that have come to light, • A typo-squatting malicious package in the official make supply chain attacks a broad category of threat. Python repository; the package contained a Although there is no single solution for the entire malicious script that downloads malware used spectrum of these types of attacks, organizations need to hijack coin mining addresses in the clipboard to build preventative protection and post-breach (reported on Medium) detection of supply chain attacks from compromised hardware and software suppliers, vendors and • Compromised script in StatCounter that allowed acquisitions, open source software suppliers, as well as attackers to inject a malicious script in websites that cloud services and infrastructure suppliers. use StatCounter (reported by ESET) SECTION II 17 Investigating cyber incidents with DART The Microsoft Detection and Response Team (DART) is a global team of cybersecurity experts and incident responders that helps organizations with detection, investigation, and response to cybersecurity incidents. This section highlights some of the customer cases that DART handled in the last year; it illustrates common attacker trends and how Microsoft and customers were able to thwart them. PROFESSIONAL SERVICES ORGANIZATION EXPERIENCED NATION STATE ATTACK THAT EXFILTRATED DATA A professional services organization was affected by Because they suspected a breach of their customer data, user authentication policies, so that a sophisticated, state-sponsored advanced persistent the organization engaged the DART team to investigate the organization has oversight into threat (APT) that gained access to privileged credentials and help prevent further damage. DART identified their security posture and can more of the organization. The attackers gained access to targeted Office 365 mailbox searches, compromised effectively mitigate risk. the network using a password spray attack, in which accounts, and attacker command and control channels. they used a small number of weak or widely used Key customer lessons from this incident were to deploy passwords (such as “p@ssword” or “123456”) to target controls to safeguard cloud services from identity- a large number of user accounts and gain Office 365 based threats and attackers. The organization adopted administrative credentials. (Password spray attacks are multi-factor authentication (MFA), conditional access used to avoid detection by limiting the number of login policies for certain cloud apps, and Office 365 logging. attempts for each account.) After infiltrating the network, To further protect itself against similar threats in the the APT performed elaborate, automated exfiltration of future, the organization may also adopt an endpoint data from employee mailboxes. Despite multiple in- threat detection and response (EDR) solution to detect house attempts to evict them, the adversary remained attackers that may be trying to exploit its network. in the network for more than 200 days. As part of the Furthermore, we have recommended that this attack, the adversary leveraged the organization’s supply organization appoint a cloud governance body or global chain software and automated exfiltration of data. identity team who will manage and enforce appropriate SECTION II: DART 18 SECTION III Phishing still prevails In 2018, Microsoft threat analysts have seen evidence that attackers continue to use phishing as a preferred attack method. Phishing promises to remain a problem for the foreseeable future because it involves human decisions and judgement in the face of persistent efforts by cybercriminals to make victims fall for their lures. Phishing rates are still on the rise Percentage of total inbound emails that are phishing emails NOV 2018 0.55% MAR 2018 0.60% 0.45% OCT 2018 0.50% 0.39% 0.40% FEB 2018 0.25% 0.30% 0.20% 0.10% 0.00% JAN FEB MAR APR MAY JUN JUL AUG SEPT OCT NOV DEC 2018 PHISHING CONTINUES TO BE A PREFERRED ATTACK VECTOR IN 2018 FIGURE 8. Phishing emails in 2018 Microsoft analyzes and scans in Office 365 more than 470 billion email messages every month for phishing and malware, which provides analysts with considerable insight into attacker trends and techniques. The share of inbound emails that were phishing messages increased 250 percent between January and December 2018. Phishing remains one of the top attack vectors used to deliver malicious zero-day payloads to users, and Microsoft has continued to harden against these attacks with additional anti-phishing protection, detection, investigation, and response capabilities to help secure users. SECTION III 20 Evolution in phishing attack methods Phishing campaigns vary from targeted to broad-based As the tools and techniques used to protect people As with malware distribution in general, phishing from phishing become more sophisticated, attackers campaigns vary from targeted to broad-based, generic are forced to adapt themselves. Phishing attacks attacks. Although highly sophisticated attacks yield have become increasingly polymorphic, which means greater monetary gains per account phished, more attackers don’t use a single URL, domain, or IP address generic attacks yield less money per compromised to send mail, but make use of a varied infrastructure account but target a broader set of users. with multiple points of attack. The nature of the attacks themselves has also evolved, with modern phishing An example of a sophisticated, targeted campaign is campaigns ranging from short-span attacks that are Ursnif, in which attackers localized the document file active for just minutes to much longer high-volume name to be specific to a familiar organization or the campaigns. Others are serial variants attacks, wherein industry of the target. Such attacks are quite different attackers send a short volume of mail on several from broad-based campaigns and appear to be more successive days. legitimate and trustworthy. In addition, Microsoft has observed a trend toward Some of the broad-based campaigns in 2018 were attackers using hosted infrastructure and other related to business email compromise (BEC) and public cloud infrastructure, which makes it easier to impersonation of known brands, domains, or users within avoid detection by hiding among legitimate sites and the target organizations and sophisticated spoofing assets. For example, attackers increasingly use popular campaigns. Domain impersonation is a common attack document sharing and collaboration sites and services tactic used to lure organizations into believing that the to distribute malicious payloads and fake login forms email is trustworthy and should be opened. that are used to steal user credentials. There has also been an increase in the use of compromised accounts to further distribute malicious emails both inside and outside an organization. SECTION III 21 Phishing lures come in many forms Microsoft researchers have found that many different • Links to fake cloud storage locations (the email types of phishing lures or payloads are being employed message appears to come from a legitimate source in campaigns, including: and entices the user to give permission and/or enter personal information such as credentials • Domain spoofing (the email message domain is an in exchange for accessing a fake cloud storage exact match with the original domain name) location) • Domain impersonation (the email message This variety of lures that could potentially be employed domain is a look alike of the original domain name)² by attackers increases the complexity of phishing threats that organizations must contend with. • User impersonation (the email message appears to come from someone you trust) • Text lures (the text message appears to come from a legitimate source such as a bank, government agency, or other company to impart legitimateness to their claims and typically asks the victim to provide sensitive information such as usernames, passwords or sensitive financial data) • Credential phishing links (the email message contains a link to a page that resembles a login page for a legitimate site, so users will enter their login credentials) • Phishing attachments (the email message contains a malicious file attachment that the sender entices the victim to open) FOOTNOTES ² Domain impersonation may resemble domain spoofing (exact match with the original domain name) in the exceptional case where the domain appears in the email display name. SECTION III 22 Investigating cyber incidents with DART LARGE MANUFACTURING ORGANIZATION HIT BY TARGETED PHISHING INCIDENTS link. Training users to be wary of phishing scams, having tools in place to identify attackers and act, and A manufacturing organization experienced a multi- regularly patching systems are all important; if the phased phishing campaign across a span of a few organization does not address even one of these, it can months. This approach is not unusual. During the first be vulnerable. phase the attacker will perform reconnaissance and in the second phase will target high-value assets. The In this case, the most important concern of the first phase of this campaign leveraged a well-known customer was an immediate need to block access to phishing scam that was based on a web page link the compromised accounts. In partnership with Azure embedded in an email sent to a small targeted group Identity and Office 365 teams, DART devised a plan to within the organization. The email claimed that the eradicate the attacker from the network and monitor target had an important electronic document waiting any traffic to the command and control channel to be reviewed, and all the recipient had to do was by using the newly deployed Microsoft Azure Log authenticate with their domain credentials to gain Analytics solution. The team was able to help resolve access. This fake landing page set up for the target to the situation in just three hours. The attacker’s access review the so called ‘important document’ actually was blocked, and the organization could turn their harvested the credentials and allowed the attacker attention to damage assessment and recovery. DART access to Office 365 accounts from anywhere in the used the Azure Log Analytics tools to hunt for attacker world. The second phase of the phishing campaign was behavior, which helped uncover many configuration intended to send similar phishing emails to high value challenges for the organization. For example, DART assets inside the target manufacturing organization, in identified gaps in patching on critical servers, hopes to gain access to more valuable data. Microsoft discovered computers on the network communicating engaged with this client during the second phase of with known bad hosts on the Internet, and also found the phishing campaign. Key customer lessons from this several important servers without malware protection. incident were: phishing remains to be one of the most effective attack methods and users are still the weakest SECTION III: DART 23 SECTION IV Malware around the world Malware poses risks to organizations and individuals in the form of impaired usability, data loss, intellectual property theft, monetary loss, emotional distress, and can even put human life at risk. Microsoft uses a broad array of tools and techniques to identify, block, and eradicate malware infections wherever they are found. Malware encounter rates ranged from around 5 percent to more than 7 percent in 2017. In early 2018 they were elevated before decreasing throughout most of the year to just above 4 percent. Some potential reasons for the overall decrease in malware encounter rates in 2018 are the growth in adoption of Windows 10 and increased use of Windows Defender for protection. Encounter rate is the percent of computers running Windows Defender Antivirus that reported encountering malware during the month, including infection attempts that Defender blocked. FIGURE 9. Average monthly malware encounter rates worldwide by country/region in 2018 AVERAGE MONTHLY MALWARE ENCOUNTER RATE, 2018 16.00% + 12.00% to 16.00% 8.00% to 12.00% 4.00% to 8.00% > 0 to 4.00% Insufficient data Worldwide: 5.10% http://www.microsoft.com/sir SECTION IV 25 The five locations with the highest malware encounter rates during the January–December 2018 period were Ethiopia AVERAGE MONTHLY ENCOUNTER RATES OF COUNTRIES MOST IMPACTED BY MALWARE (26.33 percent average monthly encounter rate), Pakistan (18.94), the Palestinian territories (17.50), Bangladesh (16.95), and Indonesia (16.59), all of which had an average monthly encounter rate of approximately 16.59 percent or higher during the period. Infection rates tend to correlate strongly with human development factors and technology readiness within a society. All of the locations with the highest encounter rates in 2018 ranked in the bottom 40 percent of countries and regions in the 2017 Information and Communications Technologies (ICT) Index, published by the United Nations International Telecommunication Union (ICT). The five locations with the lowest malware encounter rates during that same period were Ireland (1.26), Japan (1.51), Finland (1.74), Norway (1.79) and Netherlands (1.82), all of which had an average monthly encounter rate of 1.82 percent Ethiopia: 26.33% or less during the period. These locations tend to have mature cybersecurity infrastructures and well-established programs for protecting critical infrastructure and communicating with their citizens about basic security. 18.94% Pakistan: 17.50% Palestinian territories: SECTION IV 26 Investigating cyber incidents with DART MULTIPLE FINANCIAL SERVICES ORGANIZATIONS EXPERIENCED NATION STATE ATTACKS THAT DISRUPTED OPERATIONS In one of the more destructive incidents DART has seen, was completely unmanaged, putting it at a remarkably several financial services organizations were targeted high risk of attack. The second lesson was that it is by a state-sponsored APT (a different group from the important to maintain backups of system data in an one that targeted the professional services organization offline location in case the primary data is lost. Another referenced earlier) that played out similarly. lesson was that traditional antivirus solutions may not suffice if you need to know about adversary activity. This APT gained administrative access after infecting a patient zero machine with a highly targeted, Returning to normal operational mode was the highest obfuscated backdoor implant, possibly delivered via a priority for these organizations. DART helped restore spear phishing email. Subsequently, the APT executed services by first investigating the impact and then multiple fraudulent transactions, transferring large taking necessary mitigation actions, such as removing sums of cash into foreign bank accounts. In some cases, malware from the affected systems and getting them to the attacker remained undetected for more than 100 a healthy state. The team also trained customers on how days. After the attacker realized they were detected, to use Microsoft threat investigation tools, including the attacker rapidly deployed a pre-staged attack, EDR and others, so that they could look for anomalous delivering destructive malware to more than half of behavior and attacker activity in their network. DART the systems in the environment; these customers’ emphasized that endpoint monitoring is critical for operations were shut down for several days. defending against sophisticated, targeted attacks that may go undetected by traditional antivirus solutions. There were a few key customer lessons from these incidents. The first was that software lifecycle management is especially important, which includes ensuring systems are being regularly updated (operating systems and security), patched, and audited. In one case, an organization’s Linux system environment that had an exceptionally large number of workloads running on it SECTION IV: DART 27 Guidance Guidance Building organizational resilience and meaningful risk reduction requires a security approach that includes prevention and detection and response. We have organized the following suggested security best practices and controls into those categories. PREVENTION: Preventive controls play a key role in an overall defense read this blog, which outlines some principles and strategy as the right investments can increase the tools Microsoft has used to guide and enhance cost of attacks for cybercriminals and sustain those our own security posture and some prescriptive increased attack costs over time (without requiring an roadmaps to help you plan your own initiatives. expert analyst to monitor and interpret the output). Preventive control investments should be targeted at • Apply secure configuration baselines provided by the lowest cost techniques to steadily remove cheap your software vendors. and effective attack techniques. • Keep machines up-to-date by rapidly applying Four things to consider for prevention are: the latest updates to your operating systems and applications, and immediately deploy critical security 1. Security hygiene is critical. As seen in some of the updates for OS, browsers, and email. Isolate (or cyber incidents shared in this report, common retire) machines that cannot be updated or patched. hygiene issues can undermine advanced security capabilities, so following these tips can help • Implement advanced email and browser protections. mitigate risk: Deploy a secure email gateway that has advanced threat protection capabilities for defending against • Avoid using unfamiliar free and/or pirated software. modern phishing variants. Only use software from trusted sources. • Enable host anti-malware and network defenses to • Mitigate credential theft risk, including securing get near real-time blocking responses from cloud (if privileged administrator accounts. To learn how, available in your solution). GUIDANCE 29 2. Implement access controls. Consider the following: 4. Be aware and act if you suspect anything. DETECTION AND RESPONSE: • Apply the principle of least privilege, which • Teach employees to be wary of suspicious Detection and response contribute includes implementing network segmentation, communications that request sensitive to resiliency by limiting the time removing local administrator privileges information and instruct them how to respond an attacker has access to your from end-users, and exerting caution when and report them to the organization’s security resources. This decreases attacker granting any permissions to applications operations team immediately. Training can ROI by both increasing the attacker running on the computer. also help mitigate social engineering and cost (they have to retry or modify • Limit downloading of applications to only spear-phishing attacks. their operations) and decreases those from reliable sources (an official app • Be careful when clicking on web links. return (limits probability of store). Practicing secure web browsing habits and achieving their objective). • Deploy strong code integrity policies, using solutions that provide warnings about including restricting the applications that users or block access to unsafe sites can help reduce The same cloud technology that is can run. If possible, adopt a security solution the probability of encountering websites enabling business organizations to that will restrict the code that runs in the associated with cryptocurrency mining. better meet market needs can also system core (kernel) and can block unsigned • If a computer is running exceptionally slow, help security operations better fight scripts and other forms of untrusted code. Use look for any suspicious files that are running back against attackers. application whitelisting. and feel free to submit a sample to the • To learn about software supply chain attacks operating system vendor. You can submit files and how to protect against them, read this for malware analysis to Microsoft at https:// blog from Microsoft researchers. www.microsoft.com/wdsi/filesubmission. 3. Keep backups. • Create destruction-resistant backups of your critical systems and data. • Use cloud storage services for automatic backup of data online. For data that is on premises, regularly back up important data using the 3-2-1 rule. Keep three backups of your data, on two different storage types, and at least one backup offsite. GUIDANCE 30 FIGURE 10. Available Today Near Future Evolution trajectory of SOCs OBSERVE ORIENT DECIDE ACT Field of view Extract context from Increase speed Speed up response Assistance from increases with vast mountain of data and quality with with Orchestration AI bots and intelligence data with AI, ML, and embedded and Automation augmented reality Human Expertise guidance As we look at the trajectory of Security Operations Centers (SOCs) evolution, we see technology continually increasing the speed and quality of SOC decisions and actions. Many of these innovations can be mapped to each stage of the Observe Orient Decide Act (OODA) “loop” that was documented by USAF Colonel John Boyd.³ OBSERVE – SOCs can tap into vast security intelligence quickly in response to alerts and detections. Microsoft available (from Microsoft and other sources) increasing and other vendors have integrated automated their field of view dramatically within the organization investigation capabilities as well as guidance to help and the external environment. analysts quickly make good decisions (to isolate potentially infected or compromised devices, for ORIENT – As these new data sources become available example). For the moment, the automation is focused to already overloaded SOCs, machine learning (a on quickly resolving low priority incidents so specialized subset of artificial intelligence) becomes a critical tool skills can be applied to more complex problems. to reason over these massive datasets and identify anomalies worth investigating. Security vendors ACT – Response requires rapid and accurate execution (including Microsoft) have adopted machine learning across many technologies and platforms, which is technology to quickly prioritize events (and help fuse what security orchestration and response automation these individual events into holistic incidents). technologies enable. Microsoft and many others are continuing to invest in these technologies including DECIDE – Because attack volume and complexity modern threat detection and automated response can quickly overload a SOC, analysts and incident solutions. FOOTNOTES responders need to make many decisions and act ³http://www.militaryhistoryveteran.com/ colonel-john-boyd-ooda-loop/ GUIDANCE 31 Some other trends that apply to a modern SOC are: to differentiate between legitimate activity and anomalous activity. We are seeing SOCs get a lot • Quality over quantity of alert feeds – As more value out of context rich detections like: organizations shift from managing “not enough information” to managing “too much information”, • Endpoint Detection and Response (EDR) the time and attention of highly specialized SOC solutions that have deep context on the host analysts becomes more and more valuable. This activity drives an increased need for quality in the alerts • Identity based detections that include insight that require Tier 1 and 2 analyst engagement. on normal user authentication patterns While additional data feeds are always helpful for (locations, times, services accessed, etc.) and investigations and proactive hunting, Microsoft’s apply behavior analytics Corporate IT SOC measures the true positive rate of alert feeds that require analyst response (and These context rich detections are harder to evade by currently requires 90% or higher true positive rate). adversaries because they have to mimic a much more complex operation (vs. a few technical attributes of IP • Data gravity – Analytics over large datasets (including traffic). security data) is difficult to do without access to the underlying raw data. As more security data is available, Another lesson we have learned from major breaches it becomes more economical and practical to perform at customers was the difficulty of rapidly responding the security analytics in the cloud vs. backhauling that to incidents when IT functions are partially or fully data to an on-premises system. This will likely lead outsourced. We recommend reviewing your IT to evolution of SIEM and SOC architectures that may outsourcing contracts and service level agreements include hybrid SIEM approaches or adoption of native (SLAs) as well as supply chain vendors to ensure they cloud SIEM as a service. are compatible with rapid security response. For more learnings from our incident investigations at customers, • High context – These types of detections are much see the Incident Response Reference Guide (IRRG) at more useful because of their ability to correlate https://aka.ms/IRRG. datasets more effectively. While traditional network traffic based detections still provide some security value, raw network traffic typically lacks context GUIDANCE 32 Data sources Data sources Microsoft has collected the data included in the Microsoft Security Intelligence Report through the course of providing a wide range of Microsoft products and services, as discussed in the Microsoft Privacy Statement. This data provides us valuable information about the security and operations of our products and services, as well as insights about the cybersecurity threat landscape generally. This data includes analytics from the following sources:⁴ • Azure Security Center is a service that helps organizations prevent, detect, and respond to threats by providing increased visibility into the security of cloud workloads and using advanced analytics and threat intelligence to detect attacks. • Bing is the search and decision engine that performs billions of webpage scans per year to seek out malicious content. After such content is detected, Bing displays warnings to users to help prevent infection. • Exchange Online is the Microsoft-hosted email and productivity service. Exchange Online antimalware and antispam services scan billions of messages every year to identify and block spam and malware. • Malicious Software Removal Tool (MSRT) is a free tool that Microsoft designed to help identify and remove specific prevalent malware families from customer computers. The MSRT is primarily released as an important update through Windows Update, Microsoft Update, and Automatic Updates. A version of the tool is also available from the Microsoft Download Center. The MSRT is not a replacement for an up-to-date real-time antivirus solution. • Microsoft Safety Scanner is a free downloadable security tool that provides on-demand scanning and helps remove malware and other malicious software. The Microsoft Safety Scanner is not a replacement for an up-to-date antivirus solution, because it does not offer real-time protection and cannot prevent a computer from becoming FOOTNOTES infected. ⁴Importantly, this data always goes through strict privacy and compliance boundaries before being used for security. DATA SOURCES 34 • Microsoft Security Essentials is a free, easy-to-download real-time protection product that provides basic, effective antivirus and antispyware protection for Windows Vista and Windows 7. • Microsoft System Center Endpoint Protection (formerly Forefront Client Security and Forefront Endpoint Protection) is a unified product that provides protection from malware and unwanted software for enterprise desktops, laptops, and server operating systems. It uses the Microsoft Malware Protection Engine and the Microsoft antivirus signature database to provide real-time, scheduled, and on-demand protection. • Office 365 is the Microsoft Office subscription service for organizations and home users. Select subscription plans include access to Office 365 Advanced Threat Protection. • Windows Security in Windows 10 provides real-time scanning and removal of malware and unwanted software. In addition, the latest version of Windows leverages rich contextual data such as machine configuration, device performance and health, and other such information to enhance security for customers. At the same time, we empower customers to be more informed about their privacy in Windows 10. Read this blog to learn about some of the ways Microsoft does so. • Windows Defender Advanced Threat Protection is a service built into Windows 10 Anniversary Update and later versions that enables enterprise customers to detect, investigate, and remediate advanced persistent threats and data breaches on their networks. • Windows Defender Offline is a downloadable tool that can be used to create a bootable CD, DVD, or USB flash drive to scan a computer for malware and other threats. It does not offer real-time protection and is not a substitute for an up-to-date antimalware solution. • Windows Defender SmartScreen, a feature in Microsoft Edge and Internet Explorer, offers users protection against phishing sites and sites that host malware. Microsoft maintains a database of phishing and malware sites reported by users of Microsoft Edge, Internet Explorer, and other Microsoft products and services. When a user attempts to visit a site in the database with the filter enabled, the browser displays a warning and blocks navigation to the page. DATA SOURCES 35