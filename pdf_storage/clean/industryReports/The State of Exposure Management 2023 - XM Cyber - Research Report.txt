The State of Exposure Management in 2023 Table of Contents Executive Summary 3 Key Findings 3 A Primer on Attack Paths 4 Lessons From a Year of Attack Path Assessments 5 Organizations are overwhelmed by security exposures 5 Most security exposures don’t represent a critical risk 7 Attack path analysis enables ultra-efficient remediation 9 Attack paths are abundant—and short 11 You can’t protect the cloud without protecting on-prem 13 Top attack techniques in 2022 reveal common themes 15 Exposure management goes far beyond vulnerabilities 18 Active Directory is the Achilles’ heel of exposure management 20 Organizations are too lax with local credentials 22 EDR is not the silver bullet many think it is 24 Concluding Thoughts 26 Appendix A: Top Attack Path Techniques 28 Top techniques in on-prem environments 28 Top techniques in AWS environments 29 Top techniques in Azure environments 29 Top techniques in GCP environments 30 Navigating the Paths of Risk: The State of Exposure Management in 2023 2 Executive Ask anyone responsible for managing cyber defenses about their biggest pain points, and they’ll likely mention being overwhelmed by Summary fixing too many things and facing too many threats. As a result, the need to pinpoint and prioritize the most critical risks sits atop the wish list of many security leaders. This is one reason why exposure management is receiving so much attention of late. In a nutshell, exposure management holistically evaluates all the ways attackers can compromise key information systems and spotlights the most likely paths to those assets. This allows your security team to focus on critical paths, effectively stopping attackers in their tracks. Our second annual report1 presents key insights drawn from tens of thousands of attack path assessments conducted through XM Cyber’s exposure management platform during 2022. These assessments uncovered over 60 million exposures affecting 10 million entities deemed critical to business operations. Anonymized datasets were exported from the XM Cyber platform and provided to Cyentia Institute for analysis. We present highlights from that analysis below. Key Findings Only 2% of exposures lie Techniques targeting on choke points leading to credentials and permissions critical assets. Focusing on these affect 82% organizations maximizes risk reduction while and constitute over 70% of all minimizing remediation workload. identified security exposures. Organizations typically have Attackers can access 70% 7 in 10 firms are vulnerable 11,000 security exposures of critical assets in on-prem to prominent remote code attackers could exploit, and networks in just 3 steps. It’s even execution vulnerabilities, but some larger enterprises have worse in the cloud, where 90% these vulnerabilities collectively over 20x that number! of critical assets are just one hop exploit less than 3% of critical away from initial compromise. assets. On the positive side, 75% of 71% of firms have exposures Endpoint detection and exposed resources lead to dead that enable attackers to pivot response capabilities cover ends that can’t reach critical from their on-prem to cloud fewer than half of all devices assets. Deprioritize these and environment. Once there, 92% in 38% of firms. focus on the exposures that have of critical assets lie just one attack paths to critical assets. hop away. 1 Download the 2021 Attack Path Management Impact Report: https://info.xmcyber.com/attack-path-management-impact-report Navigating the Paths of Risk: The State of Exposure Management in 2023 3 A Primer Organizations face a constant threat of cyber attacks that can jeopardize their critical assets. Attack paths are the most common way that attackers on Attack use to penetrate enterprise defenses. Many organizations, however, rely on tools that are narrowly focused on certain types of exposures, such as Paths unpatched vulnerabilities. This approach is flawed because attackers do not see networks and systems as individual exposures. Instead, they leverage a combination of vulnerabilities, misconfigurations, overly permissive identities, and other security gaps to move across environments and reach target assets. This route is called an attack path, and attackers can remain hidden inside networks for weeks or months, causing significant and ongoing damage. Figure 1: Example attack The attack graph depicted in Figure 1 shows possible attack paths toward graph showing paths toward enterprise assets, with the green circles representing choke points—key critical assets junctures where multiple attack paths converge toward critical assets. Focusing defenses on such choke points allows for efficient reduction of risk for the organization. At XM Cyber, we believe that understanding the relationship and context of attack paths toward critical assets is essential to mitigating risk. By visualizing all possible attack paths on an attack graph, we can quickly and accurately remediate issues by focusing on the most critical exposures that converge on choke points, thereby making all exposures leading to choke points less critical as they can’t lead an attacker to critical assets. This approach enables productive remediation that reduces risk in the most cost-efficient manner. Navigating the Paths of Risk: The State of Exposure Management in 2023 4 Lessons From a Year of Attack Path A typical organization has Assessments 11,000 exploitable security Organizations are overwhelmed exposures in a given month. by security exposures For many organizations, cybersecurity devolves into a never-ending game of whack-a-mole. Security exposures pop up; security teams knock out as many as they can as quickly as possible, and all the while, new issues continue to emerge. And contrary to the talk track of many industry thought leaders, it’s the volume rather than the vigor Larger enterprises of cyber threats that overwhelm most security programs. can have over We’re not in the business of making empty claims, so let’s quantify 250,000 that volume based on what XM Cyber has observed across its customers over the last year. The typical organization has 11,000 open exposures. exposures that attackers could leverage to compromise assets. And the top 5% of firms—mainly larger enterprises—contend with over 20x that number! This includes unpatched vulnerabilities, system misconfigurations, mismanaged credentials, inadequately protected resources, and a host of other security issues. Figure 2: Distribution of attack path exposures identified across organizations Exposure: Any combination of a vulnerable resource and credible threat technique along an attack path. Identifying which exposures represent the most risk to critical assets is the core concept behind exposure management. Navigating the Paths of Risk: The State of Exposure Management in 2023 5 Density 50% of firms have fewer 25% of firms have more than 11.0K exposures than 59.1K exposures 25% of firms have fewer than 1.8K exposures 5% of firms have more than 255K exposures Count of exposures 10 100 1k 10k 100k Research shows that the typical organization can only address about Research shows 10% of the vulnerabilities in their environments in any given month2. firms only fix Since firms are better equipped to address vulnerabilities than the 10% broader array of security exposures identified in attack path analysis, the true remediation ratio is almost certainly even lower. The good of their news is that organizations don’t need to fix them all—at least not with vulnerabilities. the same priority. We explain why in the next section. “ Many organizations have too many assets on their network to identify the key risk points, or even to map their assets. This makes it difficult to assess where and how much money should be spent. Without a way to clearly map risks to value-creating assets or processes, as well as a plan of action arising from this, it is hard to quantify and justify the resources that should be allocated to mitigating them.” World Economic Forum Global Cybersecurity Outlook 2023 XM Cyber Takeaways & Recommendations From our results, it’s clear that organizations need a way to better prioritize remediation efforts to reduce risk more efficiently. The problem is that too many get distracted by less important issues while completely overlooking those that matter most. For example, we often discover powerful administrators and Group Policy Objects that are vulnerable to exploitation as well as low-level admins that can do privilege escalations to gain full administrative rights. The priority of such exposures (and many others) won’t become clear without seeing things through an adversary’s eyes using attack path analysis. 2 Wade’s Take: Prioritization to Prediction 2 Cyentia Institute: https://www.cyentia.com/p2p-vol3-wade/ Navigating the Paths of Risk: The State of Exposure Management in 2023 6 Most security exposures don’t represent a critical risk Each organization is susceptible to an average of Many looking to assess cyber risk begin with the conceptual 39 “equation” of Threat × Vulnerability × Impact. While too simplistic to actually quantify cyber risk3, it does, at least, include some key factors different attack to evaluate. It also points to the fact that risk is minimized as any of techniques. these factors approach zero. We’ve already shown that vulnerability is decidedly NOT zero. Organizations have a multitude of security exposures that make them vulnerable to attacks. But what about the other two factors, threat and impact? Our attack path analysis offers insight into these. On the threat side of the equation, we confirmed an average of 75% 39 unique techniques in each firm that attackers could leverage to compromise assets. That may not seem like much until one realizes of exposures lead to those techniques multiply into complex attack paths through myriad dead ends that can’t vectors. Deterrence is a possible strategy, but there’s not a lot the reach critical assets. typical organization can do to stop attackers from attempting to use those techniques against them. Thus, zeroing out the threat component of risk is a dubious proposition. Figure 3: Proportion of attack paths that lead to dead ends Cloud Overall On-Prem 95.9 75.5 60.7 % % % 3 Factor Analysis of Information Risk (FAIR) is better suited to that purpose: https://www.fairinstitute.org/what-is-fair Navigating the Paths of Risk: The State of Exposure Management in 2023 7 That leaves impact. All organizations have critical information assets that, if compromised, would cause major operational and financial impacts. Those assets obviously can’t be eliminated, but threats and vulnerabilities that don’t jeopardize them can be effectively Threats and vulnerabilities “zeroed out” (deprioritized) so that security teams can focus on the most damaging exposures. Our analysis finds that three out of four that don’t jeopardize critical exposures along attack paths lead to “dead ends” that cannot impact asssets can be effectively critical assets and therefore represent minimal risk. “zeroed out”. As seen in Figure 3, dead ends tend to be more prevalent in cloud than on-premises environments. This has much to do with a combination of two factors. First, many cloud identities tend to be powerful in the sense that they have broad access to resources within the account. Second, many of those resources are not critical assets, which creates more dead ends. Dead End: An isolated exposure that can’t be used by attackers to compromise critical assets. Fixing dead ends will not lead to significant risk reduction and comes with high opportunity costs. XM Cyber Takeaways & Recommendations In the previous section, we saw that organizations cannot realistically remediate all exposures in their environment. That means they must prioritize those that represent the most risk and deprioritize those that do not. Unfortunately, the security industry tends to over-rate everything as “critical,” while offering very little to help organizations determine whether a risk can be safely ignored, delayed, or otherwise deprioritized. Part of that challenge is that it’s difficult to rule out the possibility that threats and vulnerabilities can negatively impact the organization. This is where seeing the adversary’s perspective through attack path analysis is so valuable. We’re able to determine that the necessary preconditions for exploiting certain paths do not exist (and know if that changes in the future). It’s a lot easier to find the needle when the haystack is much, much, smaller. Navigating the Paths of Risk: The State of Exposure Management in 2023 8 Attack path analysis enables ultra-efficient remediation Earlier, we saw that the typical organization has 11,000 security exposures that attackers could exploit. These are denoted by the Organizations can squares in Figure 4, each of which represents 10 exposures. The vast practically eliminate majority of exposures are dead ends or don’t put critical assets at risk, all attack paths to which is why we’ve grayed them out. critical assets by remediating just 2% About 2% (~200) of these exposures are located on choke points - of exposures that lie entities through which multiple attack paths converge en route to on choke points. critical assets. These “choke points” are colored yellow and red (we’ll get to the distinction in a moment). If you’re looking for quick wins to reduce substantial risk, these offer compelling focal points. Figure 4: A depiction of the ratio of exposures on choke points (yellow and red squares) among all exposures (gray squares) in the typical attack surface Choke Point: A key entity where multiple attack paths converge before reaching critical assets. Fixing choke points exposures cuts off multiple attack paths at once, resulting in significant risk reduction. Navigating the Paths of Risk: The State of Exposure Management in 2023 9 But wait—it gets even better! Our analysis reveals that about one in four choke points exposes 10% or more of the critical assets in the environment (red squares). In other words, these exposures put attackers on the fast track to causing major harm to the organization. One in four choke Prioritizing these “game over” choke points represents a minimal points exposes effort, maximum effect approach that equates to a whopping 99.6% 10% reduction in the scope of remediation! But how do you identify the subset of truly critical points amid or more of the the throng of 11,000 ways threats may impact your organization? critical assets. XM Cyber does exactly that with attack path analysis. You can continuously see your hybrid network through the eyes of an attacker and shore up the riskiest routes of an attack before they happen. XM Cyber Takeaways & Recommendations Gartner® recommends4 that organizations should “establish regular repeatable cycles as part of your continuous threat exposure management program, with each cycle adhering to a five steps process — scoping, discovery, prioritization, validation and mobilization — thus guaranteeing consistent threat exposure management outcomes.” Together, dead ends and choke points identified through attack path analysis are the yin and yang of exposure management. Identify and ignore dead ends to reduce workload. This will free up resources to focus on choke points for remediation. Start with the highest priority choke points that represent the largest potential impact to critical assets and work backwards from there. This, of course, is not a one-time act. In complex and ever-changing environments, organizations must have a continuous approach to exposure management. 4 Gartner, Implement a Continuous Threat Exposure Management (CTEM) Program, 21 July 2022, Jeremy D’Hoinne, Pete Shoard, Mitchell Schneider. GARTNER is a registered trademark and service mark of Gartner, Inc. and/or its affiliates in the U.S. and internationally and is used herein with permission. All rights reserved. Navigating the Paths of Risk: The State of Exposure Management in 2023 10 Attack paths are abundant — and short The efficiency gains highlighted in the last point are amazing, but exposure management isn’t just about reducing workload for Hops: Steps taken by defenders. It’s also about making attackers work harder to accomplish attackers from the point their goals. As it stands, you might be surprised how easy it is for of initial foothold to them to succeed. compromising critical assets. Hops consist of Terms like “advanced” and “persistent” are often used to describe various techniques used modern cyber threats. But do you want to know the cold, hard truth? to exploit vulnerable resources, which become Threat actors don’t work any harder than they have to, and most find the staging ground for success using attacks more aptly described as “simple” and “short.” the next hop. In support of this claim, we uncovered valid attack paths to critical assets in all organizations. Since our methods mimic those used by attackers, it’s reasonable to assume attackers can find a route to exploit just about any target, provided they do their homework and are sufficiently motivated. 51.5% 1 of critical assets 56.0% 2 of critical assets 70.0% 3 of critical assets 82.2% 4 of critical assets Figure 5: Scope of critical assets at risk with each additional hop along on-prem attack paths Navigating the Paths of Risk: The State of Exposure Management in 2023 11 But it’s not merely that vulnerable paths exist—it’s what they lead to that’s most concerning. Just over half (52%) of critical assets are In the typical reachable with a single hop from the initial access point. A couple organization, credible more hops put 70% in reach, and by four hops in, attackers can attack vectors exist for compromise 82% of critical assets in corporate on-prem networks. 90% This broadening of access as attackers progress deeper into the enterprise is depicted in Figure 5. The moral of the story of critical assets. is simple: more hops = more harm. Identifying the early-stage footholds in attack paths will dramatically lower the potential scope of compromise. Attackers can access How do attack paths in cloud environments compare to those in on-prem environments? 70% Glad you asked—we’re headed there next! of critical assets in on-prem networks within just 3 steps. XM Cyber Takeaways & Recommendations The low number of hops required to compromise high percentages of systems is alarming. But there are some root issues that heavily contribute to this state of affairs and make it increasingly easy for attackers to succeed. You can get a view of the top techniques used by attackers to compromise on-prem networks in Appendix A, and we’ll discuss these in more detail in an upcoming section. By analyzing these common techniques and how they combine to form attack paths, defenders can make it more challenging for adversaries to infiltrate systems. As discussed in prior sections, removing choke points that put adversaries on the fast track to critical assets is a key strategy for practically accomplishing this. Navigating the Paths of Risk: The State of Exposure Management in 2023 12 You can’t protect the cloud without protecting on-prem 71% Most organizations use cloud-based infrastructure or services to of firms have exposures some degree these days. This trend gives us ample opportunity to that enable pivoting analyze attack paths to and within major cloud platforms. First off, from on-prem to cloud. it’s clear that attackers able to successfully compromise corporate networks likely won’t find it difficult to expand their access to other environments. We detected exploitable attack paths from on-prem to cloud platforms in 71% of organizations. Comparatively, Amazon Web Services (AWS) offers the fewest opportunities for attackers to migrate to the cloud (47% of firms), After accessing Microsoft Azure is slightly more susceptible (80% of firms), and cloud environments, Google Cloud Platform (GCP) falls square in the middle of that range. 92% There are many plausible explanations for this difference, but a big driver is how these platforms tend to be used. Azure has a larger user of critical assets lie population in most enterprises due to extensive SaaS offerings (e.g., just one hop away. Microsoft 365), whereas AWS is generally more restricted to DevOps staff. There’s also more connectivity between on-prem and Azure environments in most enterprises because of Active Directory (AD) integration. This results in more opportunities for actors to move from on-prem to cloud. 92% 1 of critical assets 96% 2 of critical assets 98% 3 of critical assets Figure 6: Scope of critical assets at risk with each additional hop along cloud attack paths Navigating the Paths of Risk: The State of Exposure Management in 2023 13 Pivoting from on-prem networks isn’t the only way attackers infiltrate cloud platforms. On average, almost half of firms (48%) have public- facing virtual machines that expose critical assets. This makes the 48% process of gaining an initial foothold in the cloud even easier. of organizations have Regardless of the initial access vector, attack paths in the cloud tend public-facing virtual to be much shorter than on-prem. We found that an average of 92% machines that expose of assets hosted by firms in the cloud can be compromised in a single critical assets. hop! And for this statistic, there’s no significant difference across the big three cloud platforms. XM Cyber Takeaways & Recommendations Organizations face tough challenges in managing their diverse on-prem and cloud environments. Part of that struggle stems from failing to consider the big picture and only focusing on each piece in isolation. This creates gaps in security, which are exemplified by the statistics in this section. Half of organizations expose assets through public-facing VMs and the majority of them have holes attackers can use to pivot between on-prem and cloud environments. Once attackers infiltrate cloud environments, it’s very easy for them to compromise assets. Part of the challenge is that cloud security is not yet mature and many security teams don’t fully understand what security issues to look out for. Challenges also arise from how cloud identities and permissions are (mis)managed. We need to rethink our approach to security to ensure that we are protecting all of our identities, systems, and interdepencies among them holistically. Wondering how attackers hop around cloud environments so quickly? That’s definitely top of mind for us as well, and we dig into the top techniques in the next section. Navigating the Paths of Risk: The State of Exposure Management in 2023 14 Top attack techniques in 2022 reveal common themes Techniques targeting credentials and permissions affect 82% Understanding potential attack techniques is essential to exposure of organizations and management because they are the building blocks of attack paths. Multiple techniques strung together create an attack vector, and constitute 72% multiple vectors comprise an attack path. The XM Cyber platform of all identified security generates and tests many combinations of techniques to identify exposures. valid paths to critical assets. How are techniques used in attack paths? The example attack path below started from a random workstation machine in the on-prem environment. After exploiting some credentials issues in the enterprise environment, we were able to pivot into the cloud (Azure environment) by harvesting valid Azure access tokens (claimed with MFA). Once the Azure recon phase was complete, we were able to escalate our privileges and finally compromise an Intune (Azure MDM solution for managing devices) Administrator User. By abusing the permissions of that user, we could execute code back on the enterprise machines that he managed. Continued lateral movement would have led to the compromise of the entire enterprise environment. Figure 7: Example attack vector consisting of multiple techniques Navigating the Paths of Risk: The State of Exposure Management in 2023 15 It’s important to know two things about attack techniques we discuss in the following sections. First, adversaries can use the same techniques multiple times across many attack vectors, greatly amplifying their total number of options available to them. Second, our analysis verifies that all conditions exist for attackers to successfully exploit these techniques in the target environment. With that said, let’s examine the top techniques observed by XM Cyber during attack path analyses conducted in 2022. We focus here on key themes or categories of techniques, but you’ll find detailed listings of techniques for on-prem, Azure, AWS, and GCP in Appendix A. As measured from the proportion of organizations affected, attack path techniques targeting network and IT services are the most common themes overall. Frequently observed techniques in these categories include proxy spoofing, DHCPv6 DNS poisoning, exploits against Windows Server Update Services, dumping and using private SSH keys, and hijacking SSH sessions. It’s noteworthy that these technique categories are decidedly less dominant when you measure the percentage of detected exposures they potentially exploit. In other words, they offer attackers broad but relatively shallow use. Network Techniques 88% 1% IT Services 85% 8% Active Directory 82% 82% RCE Vulnerabilities 71% 1% Azure Techniques 33% 6% AWS Techniques 24% 1% Kubernetes Techniques 23% <0.1% GCP Techniques 12% 1% Figure 8: Categories of techniques targeting exposures identified by attack path analysis Techniques that target AD and misappropriate user credentials are also very common (82% of organizations). What’s more, these techniques are able to exploit 72% of all identified security exposures! That’s important enough to warrant additional analysis, so we’ll leave it be for now and pick up this AD thread in a dedicated section to follow. Navigating the Paths of Risk: The State of Exposure Management in 2023 16 Exploits of prominent remote code execution (RCE) vulnerabilities in the CVE List were observed in 71% of firms but associated with just 0.7% of exposures. That points to a common misconception about exposure management—that it’s all about patching vulnerabilities. While patching is absolutely a core component of security operations, there’s a lot of risk exposure that falls outside that scope. We explore this further and provide more details about those CVEs in the next section. And that brings us to the top techniques targeting each of the three major cloud platforms and Kubernetes. Their prevalence across organizations is, of course, largely dependent on which are more widely used. In terms of total exposures, Azure offers the largest attack surface for the same reasons we mentioned earlier (larger user population and deeper AD integration). XM Cyber Takeaways & Recommendations We find that many security teams overlook attack paths that leverage credentials and permissions. It’s also a common misconception that implementing a zero trust architecture is sufficient to protect against all techniques that exploit forms of trust. These results, however, make it clear that attackers prey upon trusted administrative services and identities. Attack paths exploiting AD are of particular concern because they represent a huge attack surface. The relationships within AD can be highly complex and difficult to understand. It’s crucial that organizations pay close attention to AD exposures and not solely rely on zero trust security measures. Navigating the Paths of Risk: The State of Exposure Management in 2023 17 Exposure management goes far beyond vulnerabilities 71% of firms are vulnerable In the prior section, we saw that the majority of organizations (but a small minority of exposures within them) have active attack paths that to prominent remote exploit known vulnerabilities (CVEs). This is particularly interesting code execution because XM Cyber is not a traditional vulnerability scanner that seeks to vulnerabilities. identify all unpatched vulnerabilities across the enterprise. In general, our attack path analysis looks for vulnerabilities that involve remote code execution and are widely exploited by attackers. Research puts the percentage of published CVEs exploited in the wild at about 6%.5 These vulnerabilities The top vulnerabilities identified through XM Cyber’s attack path collectively exploit analysis are shown in the chart below. The infamous “PrintNightmare” less than exploit (CVE-2021-34527) reigns supreme across all four measures, affecting 54% of organizations, 0.5% of total exposures, and about 3% 3% of all critical assets and choke points. A patch for this CVE has existed for some time, but there are some registry key configurations that make of critical assets. the patch irrelevant. Text4Shell and Log4j exploits also rank high on the list in terms of vulnerable organizations and assets. Figure 9: Top vulnerabilities identified by attack path analysis. OOrrggaanniizzaattiioonnss EExxppoossuurreess CCrriittiiccaall AAsssseettss CChhookkee PPooiinnttss PPrriinnttNNiigghhttmmaarree -- WWiinnddoowwss PPrriinntt SSppoooolleerr ((CCVVEE--22002211--3344552277)) 5544..22%% 00..55%% 22..88%% 33..33%% TTeexxtt44SShheellll VVuullnneerraabbiilliittyy 4422..77%% 00..00%% 22..66%% 00..11%% UUllttrraaVVNNCC VVuullnneerraabbiilliittiieess ((CCVVEE--22001199--88227777)) 1188..88%% 00..11%% 00..22%% 00..66%% LLoogg44jj VVuullnneerraabbiilliittiieess 3333..33%% 00..00%% 22..66%% 00..11%% DDeejjaaBBlluuee 2288..11%% 00..00%% 00..55%% 00..00%% EEtteerrnnaallBBlluuee ((CCVVEE--22001177--00114444)) 1188..88%% 00..00%% 00..22%% 00..00%% FFoolllliinnaa -- MMiiccrroossoofftt ooffffiiccee ((CCVVEE--22002222--3300119900)) 2255..00%% 00..00%% 00..00%% 00..11%% SSMMBBGGhhoosstt ((CCVVEE--22002200--00779966)) 1166..77%% 00..00%% 00..55%% 00..00%% aaPPAACCoollyyppssee ((CCVVEE--22001177--1111990077)) 1188..88%% 00..00%% 00..00%% 00..00%% SSpprriinngg44SShheellll -- CCVVEE--22002222--2222996655 2200..88%% 00..00%% 00..77%% 00..00%% BBlluueeKKeeeepp ((CCVVEE--22001199--00770088)) 1177..77%% 00..00%% 00..11%% 00..00%% LLNNKK EExxppllooiittss 2211..99%% 00..00%% 00..00%% 00..00%% PPrrooxxyyNNoottSShheellll RRCCEE ((CCVVEE--22002222--4411004400 aanndd CCVVEE--22002222--4411008822)) 1133..55%% 00..00%% 00..44%% 00..00%% NNooPPaacc ((CCVVEE--22002211--4422227788,, CCVVEE--22002211--4422228877)) 88..33%% 00..00%% 00..33%% 00..00%% Scanning over the rest of the top vulnerabilities, one may wonder why CVEs published back in 2017 (e.g., UltraVNC, aPAColypse) still enable valid attack paths 5+ years later. The simple answer is that it can take a surprisingly long time to remediate vulnerabilities in enterprise environments. 5 Enhancing Vulnerability Prioritization: Data-Driven Exploit Predictions with Community-Driven Insights. Navigating the Paths of Risk: The State of Exposure Management in 2023 18 Figure 10: Survival analysis of vulnerabilities identified by attack path analysis 100% 80% 60% 2 out of every 5 vulnerabilities are still open a month after discovery 40% 1 out of every 7 vulnerabilities are still open six months after discovery 20% 0% 1 2 3 4 5 6 7 8 9 10 11 1 month months year Time to Remediation Navigating the Paths of Risk: The State of Exposure Management in 2023 19 nepO llitS tnecreP The chart below applies a technique called survival analysis to project how quickly organizations remediate these vulnerabilities based on data provided by Kenna Security6. About 40% of vulnerabilities remain open a month after discovery and 5% persist for longer than a year without being remediated. And keep in mind that these are critical vulnerabilities that have known exploits and should receive priority attention! Obviously, improving the speed at which these (and other) vulnerabilities are remediated would reduce exposure. But let’s not lose sight of a critical point made in the previous section: exploiting CVE-based vulnerabilities is only one category of techniques attackers employ to infiltrate target organizations and compromise critical assets. Exposure management must address all attack vectors, particularly those on an attack path toward critical assets. We’ll examine the most common issues (identities, credentials, and permissions) in the next two sections. XM Cyber Takeaways & Recommendations In terms of overall risk to critical assets, exposures associated with CVE-based vulnerabilities are dwarfed by those involving compromised identities and credentials. That doesn’t mean vulnerabilities shouldn’t be patched…but it absolutely does mean that protecting critical assets requires a much more holistic approach to exposure management. This includes misconfigurations, mismanaged credentials, excessive permissions, user behaviors, etc. These things, along with vulnerabilities, comprise your exposed attack surface. 6 See survival analysis applied to a broader array of CVEs and specific platforms in Prioritization to Prediction Vol. 5 Active Directory is the Achilles’ heel of exposure management The preponderance of AD and other identity and access management issues is hard to ignore (72% of all exposures!). As are the findings of a five-year study7 of extreme cyber events that 80% pointed to credential-related attacks as the most common and costly technique used by attackers. of organizations Active Directory is a prime target in such attacks because it offers are vulnerable to a veritable treasure trove of credentials for privilege escalation and credential dumping lateral movement. This is why credential dumping and domain techniques. credentials rank high on the list of top Active Directory attack techniques in the chart below. Tools like Mimikatz make this all-too-easy to execute and are extremely popular (as the “Groups” and “References” sections on the MITRE page attest). Figure 11: Top Active Directory techniques identified by attack path analysis Organizations Exposures Critical Assets Choke Points Credential Dump Orga8n0i.z2a%tions Exp2o.7s%ures Critic7a.l3 A%ssets Chok4e.3 P%oints ReseCt rUesdeern Ptiaasl sDwuomrpd 8706..20%% 128.7.8%% 73..32%% 43..35%% ReDsoemt Uaisne Cr Preadsesnwtioarlds 7765..00%% 128.7.8%% 37..20%% 135.5.7%% Resource-Based ConDstoraminaeind CDreeldeegnattiiaolns 7756..00%% 28..75%% 73..06%% 175.9.7%% Resource-Based ConstrAaidnde dL oDgeolne gSactriiopnt 7766..00%% 188.5.7%% 32..68%% 73..98%% Add MAedmdb Leorsg oton GSrcoriuppt 7767..01%% 1184..78%% 22..81%% 30..85%% Add MCermedbeenrtsi atols GRreoluapy 7578..13%% 104.4.8%% 23..11%% 04..52%% MCreemdbeenrt iOalfs GRreoluapy 5782..39%% 06..47%% 32..19%% 40..24%% MMeemmbbeerr Ooff GGrroouupp 772.3.9%% 61..73%% 23..91%% 00..41%% MAemddb eAr CoEf Gtor oOuUp 676.3.7%% 10..39%% 32..19%% 00..10%% ChangAe dthde A GCPEO t oP OatUh 6568..73%% 00..93%% 20..95%% 00..01%% Change the GPO Path 58.3% 0.3% 0.5% 0.1% 7 The Cyentia Institute Navigating the Paths of Risk: The State of Exposure Management in 2023 20 It’s never a good thing when credentials are abused through techniques like those listed in Figure 11. But it’s so much worse when those credentials gift attackers far more access than necessary for legitimate use. The concept of “least privilege” is one of the 36% oldest in the infosec field, prescribing that users and computers shouldn’t have more permissions than necessary for their functions. of firms grant That’s easier said than done, which is why some say “least permissions enabling practiced” would be a more fitting term. Our data suggests they at least half of their might be right. devices to access critical assets. About one in five (22%) of organizations grant elevated privileges to at least half of their user population. Even more concerning, greater than half of the computing devices in over a third (36%) of the organizations have sufficient privileges to access critical assets if compromised. You don’t have to be a mathlete to know those numbers don’t equate to least privilege, or, the more current en vogue term, Zero Trust principles. XM Cyber Takeaways & Recommendations AD is a critical, yet highly complex, component in almost every organization. As a result, the attack surface associated with AD can be extensive and pose a substantial risk to critical assets (as evidenced by these findings). Unfortunately, AD issues can be challenging for organizations to understand and solve. This leads to their being overlooked or under- prioritized, while attackers take advantage of them on a daily basis. It’s therefore crucial to protect credentials and prioritize efforts to shore up AD security. These lessons8 shared by Microsoft’s Detection and Response Team should help get you started. 8 Total Identity Compromise: DART lessons on securing Active Directory Navigating the Paths of Risk: The State of Exposure Management in 2023 21 Organizations are too lax with local credentials Dumping credentials and exploiting excessive permissions are standard techniques in attackers’ repertoires, and most security teams at least have them on their radar. Something that often flies under the radar, however, is the propensity for credentials to be cached and/or stored 76% locally. Granted, doing this is sometimes necessary for administrative In of purposes. But, in our experience, administrative credentials have a organizations, we tendency to scatter well beyond their intended scope. identified highly privileged users whose We’ll start with some observations around cached credentials. We credentials were identified highly privileged users whose credentials were cached on cached on multiple multiple machines in 76% of organizations. On average, 12% of Active machines. Directory users have cached credentials on more than one machine. Of those, about 10% have admin-level permissions on 100 or more devices. Perhaps a few specialized organizations need that level of broad access, but most simply aren’t aware of the issue at all. Let’s focus on local credentials, which are generally a far riskier issue— yet relatively easy to solve. We identified local credential issues in two-thirds of organizations. A quarter of organizations (26%) have what we suspect are “golden image” issues, whereby local credentials may be unwittingly replicated to devices or virtual machines when new instances are deployed from the image. Proportion of Organizations Proportion of Credentials Both 80% Server 42% Desktop 13% Desktop 42% Server 7% Both 16% Figure 12: Prevalence of local credentials across desktops and servers Navigating the Paths of Risk: The State of Exposure Management in 2023 22 While there might be a tendency to think of this as more of a desktop problem, the reality is that 80% of organizations with 67% local credential issues have golden image–sourced credentials on both desktops and servers within their environment. With of organizations respect to the credentials themselves, they’re scattered evenly have issues with local between desktops and servers (~42% each). The remaining credentials. 16% are duplicated to both. XM Cyber Takeaways & Recommendations In general, credential issues pose a big risk within organizations. Credentials are used many times by attackers to move laterally within the organization, supporting the fact that organizations need to have an easy way of finding and reducing this attack vector and a dedicated remediation process that regularly reviews and monitors their privileged user access and credential management practices. This includes auditing cached credentials and ensuring that administrative privileges are only granted on a need-to-know basis. Additionally, organizations should prioritize the elimination of local credential issues by implementing security measures such as secure password management, reducing the use of golden images, and implementing least privilege access controls. By taking these steps, organizations can reduce their risk of credential theft and minimize the potential impact of a security breach. Navigating the Paths of Risk: The State of Exposure Management in 2023 23 EDR is not the silver bullet many think it is As cyber threats proliferated, it became apparent that traditional security tools like antivirus and network intrusion detection systems couldn’t adequately protect user devices. A new generation of solutions evolved under the moniker of endpoint detection and 38% response (EDR). Many security teams view EDR as a fail-safe last line of defense when adversaries circumvent all other controls to make of firms have endpoint their way to endpoints. protection running on But increasing EDR adoption hasn’t seemed to slow the regular fewer than half of their drumbeat of headlines announcing new security breaches. This begs endpoints. the question of why. First, it’s worth confirming that our data does indeed point to the widespread adoption of EDR. Only about one in five organizations don’t have it deployed in at least some part of their environment. Those deployments cover 73% of the endpoints identified by our analyses. Among those, Linux and MacOSX endpoints are the least likely to have EDR. Environments with EDR Windows Server 86% Windows Desktop 70% macOS 52% Linux 39% Figure 13: DR coverage by category of endpoint Some may view these high EDR adoption rates as contradictory to earlier sections that detailed how large proportions of critical assets can be compromised in just a few steps. Perhaps you’re asking, “Is that only the case in environments without EDR?” The answer is no. We see little difference in those statistics between organizations with pervasive and shallow EDR deployments. Navigating the Paths of Risk: The State of Exposure Management in 2023 24 How do we resolve this apparent contradiction? Well, first, we see wide disparity when it comes to the breadth and depth of EDR deployment. Over a third of organizations (38%) have EDR running on less than half of the devices in their network. Only about one in ten have EDR fully functional on at least 90% of their endpoints. That might tick the “has EDR” box, but it won’t stop savvy adversaries from forging a path to unprotected assets. The truth is that EDR solutions aren’t a silver bullet. Partial deployments, improper configuration, and management challenges are the norm. Unfortunately, these issues allow attackers to bypass this presumed last line of defense without much resistance. Curious about how daunting your EDR solution looks from an attacker’s point of view? We’re happy to help with that—but be forewarned—you might not like what you see. Figure 14: Percentage of endpoints running EDR among organizations Percent of Assets XM Cyber Takeaways & Recommendations We see two major erroneous assumptions when it comes to EDR. First, organizations assume their solution is running on all applicable endpoints (our results show it rarely is). Second, they assume that “EDR has our back” and offers a rock-solid last line of defense. The reality is that we find just as many attack vectors to critical assets among heavy EDR deployments as we do among lite EDR environments. It’s essential to ensure that your security measures are configured properly and deployed consistently across all environments. This is important because you cannot always rely on your endpoint detection and response (EDR) solutions to detect and mitigate all threats. Therefore, it’s crucial to have a comprehensive and proactive security strategy that includes multiple layers of defense, such as network security, identity and access management, and endpoint security. By implementing a well-configured and integrated security solution, you can enhance your overall security posture and reduce the risk of successful attacks. Navigating the Paths of Risk: The State of Exposure Management in 2023 25 snoitazinagrO fo tnecreP 38% of Organizations have EDR running on less than half 48% of the devices in their environment 29% 14% 9% Concluding Thoughts As we analyzed data and reflected on the findings for this report, my mind kept coming back to one concept: the cost of attack. I’ve long been preoccupied with the concept of making it more costly for attackers to successfully compromise our organizations than the value they get from doing so. In fact, I wrote this in the very first edition of Verizon’s Data Breach Investigations Report in 2008: “Though some movie plots would have us believe otherwise, cyber attacks in the real world rarely involve Mission Impossible-like scenarios. Quite the opposite, in fact… Given enough time, resources and inclination, criminals can breach virtually any single organization they choose. They cannot breach all organizations…Unless the value of the information to the criminal is inordinately high, it is not optimal for him to expend his limited resources on a hardened target while a softer one is available. The goal, then, is to implement security measures such that it costs the criminal more to compromise your organization than other available targets.” 2008 was a long time ago, and I’d like to think we would have reached that goal by now. But as best I can tell, we haven’t—at least not for the majority of organizations. And that’s why I’m fascinated with what we learned in this analysis based on what XM Cyber are doing through attack path analysis. We can see what the attacker sees and identify their least costly (quickest, easiest) routes to whatever it is they value. The concept of choke points shows where we can disrupt those routes most efficiently so attackers cannot achieve their objective. If we can operationalize that knowledge, I have hope that we actually can shift the cost of attack in our favor. And that would make me very happy, indeed! Wade Baker, Ph.D., Co-Founder, Cyentia Institute Navigating the Paths of Risk: The State of Exposure Management in 2023 26 To operationalize this data, XM Cyber recommends that organizations should: Conduct a comprehensive Focus on techniques targeting Monitor and track progress exposure assessment of their credentials and permissions as regularly to ensure that systems and infrastructure to they affect a large percentage exposures are being remediated identify all exploitable security of organizations and exploit a in a timely manner. exposures. significant portion of all identified security exposures. Prioritize the remediation Grant elevated privileges only Implement Zero Trust principles of exposures that lie on choke to those users who need them and limit local credentials to points, as they provide attackers and ensure that they have access reduce the risk of unauthorized with a fast track to causing major only to the critical assets that they access to critical assets. harm to the organization. require to perform their jobs. Deprioritize vulnerabilities and Deploy EDR on all endpoints to exposures that do not jeopardize protect against savvy adversaries critical assets and focus on live who may attempt to forge a path attack paths. to unprotected assets. See how we can help remediate hidden exposures in your network Book a demo Navigating the Paths of Risk: The State of Exposure Management in 2023 27 Appendix A: Top Attack Path Techniques Let’s examine the top techniques observed by XM Cyber during attack path analyses conducted in 2022. As we do, it’s important to recognize that there are several valid ways of measuring “top” techniques, each of which offers a different, useful perspective. The figures that follow present all four measures for easy consideration and comparison. Organizations: Exposures: Critical Assets: Choke Points: Percent of organizations Percent of detected Percent of critical assets Percent of choke points in which the techniques exposures associated that can be compromised associated with the were observed. with the techniques. This by the techniques. This techniques. This indicates This indicates which indicates the scope of indicates the potential how often the technique techniques are most potential exploitation impact or risk. leads to critical junctures common overall. across the environment. that then lead to critical assets and therefore enable efficient mitigation of risk. The figures that follow include techniques making the top 10 by any of these measures. Top techniques in on-prem environments Organizations Exposures Critical Assets Choke Points Organizations Exposures Critical Assets Choke Points Network Reachability 81.2% 7.9% 7.4% 17.8% RNeestweto Urks eRre Paachssawbiolirtdy 8716..20%% 178.9.8%% 73..42%% 137.5.8%% ReseCt rUesdeern Ptiaasl sDwuomrdp 7860..02%% 128.7.8%% 37..23%% 34..53%% DoCmraeidne Cnrteiadl eDnutimalps 8705..20%% 22..77%% 77..30%% 145.3.7%% Resource-Based ConDstoraminaeind CDreeldeegnattiiaolns 7756..00%% 28..75%% 73..06%% 175.9.7%% Resource-Based ConstrAaidnde dL oDgeolne gSactriiopnt 7766..00%% 188.5.7%% 32..68%% 73..98%% Add MAedmdb Leorsg oton GSrcoriuppt 7767..01%% 1184..78%% 22..81%% 30..85%% Add MLeomcable Crsr etod eGnrtoiaulps 7775..10%% 104.6.8%% 22..18%% 04..57%% MLeomcabl eCrr Oedf eGnrtoiaulps 7752..09%% 06..67%% 22..89%% 40..74%% TainMt eSmhbareerd O Cf oGnrtoeunpt 7726..90%% 65..76%% 22..95%% 01..48%% TainCt rSehdaernetdia Clso Rnetelanyt 7568..03%% 50..64%% 23..51%% 14..82%% CMreemdebnetri aolfs GRreoluapy 578.3.3%% 01..43%% 33..11%% 40..21%% MePmrobxeyr Sopf oGorfoinugp 871.3.2%% 10..33%% 30..11%% 02..11%% RDP CrPerdoexnyt iSapl Uoosfaingge 8610..24%% 00..39%% 01..16%% 27..15%% Microsoft SRQDLP C Crereddeenntitaialsl UUssaaggee 6700..48%% 00..91%% 14..64%% 70..57%% PrintNightmare - Windows PMriicnrto Sspoofto SleQr L(C CVreEd-2en0t2ia1l-s3 U4s5a2g7e) 7505..82%% 00..15%% 42..48%% 03..73%% PrintNightmare - Windows Print Spooler (CVEA-d2d0 2A1C-E3 4to5 2O7U) 5656..27%% 00..59%% 22..89%% 30..30%% Add ACE to OU 66.7% 0.9% 2.9% 0.0% Figure A1: Top techniques identified by attack path analysis in on-prem environments Navigating the Paths of Risk: The State of Exposure Management in 2023 28 Top techniques in AWS environments Organizations Exposures Critical Assets Choke Points AWS IAM Add Policy Privilege Escalation 19.8% 0.2% 2.5% 3.1% AWS Update Role Impersonation Policy 19.8% 0.1% 2.5% 2.5% AWS EC2 (AttachVolume, DetachVolume) Take Over 19.8% 0.1% 2.1% 1.1% AWS Modify EC2 Instance User Data 18.8% 0.1% 2.1% 1.1% AWS Create User Access Key 18.8% 0.0% 2.0% 0.6% AWS Update Lambda Code 18.8% 0.0% 1.4% 0.6% AWS Update Login Profile 17.7% 0.0% 1.9% 0.6% AWS Over-privileged AWS EC2 Instance Creation 19.8% 0.0% 2.0% 0.3% AWS S3 Bucket Read Data 19.8% 0.1% 0.6% 0.0% AWS S3 Bucket Write Data 18.8% 0.1% 0.6% 0.0% AWS Over-privileged AWS Lambda Function Creation 17.7% 0.0% 1.7% 0.4% AWS EC2 Role Compromise 20.8% 0.0% 1.4% 0.2% AWS EBS Share Volume Snapshot 17.7% 0.1% 0.1% 0.0% AWS Lambda Change Function Role 17.7% 0.0% 1.2% 0.4% AWS EC2 Change Machine Role 17.7% 0.0% 1.5% 0.3% AWS Add User To Group 16.7% 0.0% 1.5% 0.4% AWS EC2 SSM SendCommand takeover 12.5% 0.0% 1.5% 0.4% Figure A2: Top techniques identified by attack path analysis in AWS Top techniques in Azure environments Organizations Exposures Critical Assets Choke Points Azure Member Of Group 30.2% 1.0% 23.0% 0.2% Azure Run Command On VM 28.1% 0.3% 20.6% 0.1% Azure Run Command On VM Using VM Extensions 28.1% 0.3% 16.6% 0.1% Azure Application Owner Can Compromise the Application Service Principals 31.2% 0.2% 2.6% 0.2% Azure Add Role Assignment 30.2% 0.0% 38.4% 0.3% Azure Tables Compromise 24.0% 1.2% 9.9% 0.0% Azure Graph Role Compromise 29.2% 0.0% 35.4% 0.0% Azure Read Blobs 17.7% 0.9% 9.1% 0.0% Azure Group Member of Group 22.9% 0.1% 1.5% 0.0% Azure Queues Compromise 16.7% 0.3% 3.0% 0.0% Azure Reset Application Credentials 1.0% 0.1% 0.0% 0.2% Azure Resource Attached Identity Compromise 22.9% 0.0% 18.9% 0.0% Azure Applications Can Add Passwords to Other Applications 14.6% 0.1% 0.3% 0.1% Microsoft Intune - Execute Script 9.4% 0.0% 0.8% 0.1% Azure Upload Blobs 16.7% 0.3% 1.8% 0.0% Read OneDrive Files using Azure Applications 26.0% 0.0% 0.0% 0.0% Azure Application Can Read E-Mails 24.0% 0.0% 0.0% 0.0% Azure Automation Account Compromise 19.8% 0.0% 3.8% 0.0% Azure Key Vaults Compromise 24.0% 0.1% 0.4% 0.0% Azure List Functions publish XML keys in Azure Site 21.9% 0.1% 1.0% 0.0% Azure Automation Account Application Compromise 8.3% 0.0% 3.8% 0.0% Figure A3: Top techniques identified by attack path analysis in Azure Navigating the Paths of Risk: The State of Exposure Management in 2023 29 Top techniques in GCP environments Exposures Critical Assets Choke Points GCP Create Service Account Key 0.0% 1.2% 0.3% GCP Service Account From Resource 0.0% 1.2% 0.1% GCP Compromise Linux VM 0.1% 0.8% 0.2% GCP Allows Signing of Arbitrary Payloads 0.0% 1.1% 0.0% GCP Create VM with Specified Service Account 0.0% 1.0% 0.2% GCP Create Function with Specified Service Account 0.0% 0.9% 0.2% GCP Set a Project IAM Policy 0.0% 1.7% 0.1% GCP Read BigQuery 0.1% 0.9% 0.0% GCP Set Storage IAM Policy 0.0% 0.4% 0.3% GCP Read Data From Bucket 0.1% 0.5% 0.0% GCP Member Of Group 0.0% 1.2% 0.0% GCP Request Service Account Token 0.0% 1.1% 0.0% GCP Access Token Stealer 0.0% 0.1% 0.0% GCP Set a Folder IAM Policy 0.0% 1.5% 0.0% GCP Write Data To Bucket 0.1% 0.4% 0.0% GCP Compromise Function 0.0% 0.1% 0.0% GCP Write BigQuery 0.1% 0.9% 0.0% GCP Set an Organization IAM Policy 0.0% 1.2% 0.0% GCP Set Service Account IAM Policy 0.0% 0.9% 0.2% GCP Request Service Account Token By Implicit Delegation 0.0% 1.1% 0.0% GCP Signing Well-Formed JWT 0.0% 1.1% 0.0% Figure A4: Top techniques identified by attack path analysis in GCP Navigating the Paths of Risk: The State of Exposure Management in 2023 30 XM Cyber is a leading hybrid cloud security company that’s changing the way organizations approach cyber risk. XM Cyber transforms exposure management by demonstrating how attackers leverage and combine misconfigurations, vulnerabilities, identity exposures, and more, across AWS, Azure, GCP and on-prem environments to compromise critical assets. With XM Cyber, you can see all the ways attackers might go, and all the best ways to stop them, pinpointing where to remediate exposures with a fraction of the effort. Visit www.xmcyber.com to learn more. Analysis for this report was provided by the Cyentia Institute. Cyentia is a research and data science firm working to advance cybersecurity knowledge and practice. We do this by partnering with security vendors and other organizations to publish a range of high-quality, data-driven content like this study. Find out more at www.cyentia.com The State of Exposure Management in 2023