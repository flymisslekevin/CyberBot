Toward a Knowledge Graph of Cybersecurity Countermeasures Peter E. Kaloroumakis Michael J. Smith The MITRE Corporation The MITRE Corporation Annapolis Junction, MD Annapolis Junction, MD pk@mitre.org smithmj@mitre.org Abstract—Thispaperdescribesourresearchanddevelopment A cybersecurity countermeasure is any process or tech- toward a precise, unambiguous, and information-dense knowl- nology developed to negate or offset offensive cyber activi- edge graph of cybersecurity countermeasures. In project work ties. It is not enough to understand what a countermeasure for our sponsors we have repeatedly encountered the need for does—what it detects, what it prevents. We must understand a model that can identify and precisely specify cybersecurity countermeasure components and capabilities. Furthermore, it how it does it. A security architect must understand their is necessary that practitioners know not only what threats a organization’s countermeasures—precisely what they do, how capability claims to address, but, specifically how those threats they do it, and their limitations—if countermeasures are to are addressed from an engineering perspective, and under be effectively employed. A red team conducting an exercise what circumstances the solution would work. This knowledge to identify security gaps must plan their engagement with is essential to estimate operational applicability, vulnerabilities, anddevelopenterprisesolutionscomprisingmultiplecapabilities. expert knowledge of a countermeasure’s functionality if they To address this recurring need in the near-term, we created aretoevadeit.Aventurecapitalistconsideringacybersecurity D3FEND, a framework in which we encode a countermeasure startup must understand what problem it is trying to solve, knowledge base, but more specifically, a knowledge graph. The whether and how it has been solved before, and why the graph contains semantically rigorous types and relations that proposed solution is better or novel. defineboththekeyconceptsinthecybersecuritycountermeasure domain and the relations necessary to link those concepts to Existingcybersecurityknowledgebasesdonotexplainwith each other. We ground each of the concepts and relations to enough fidelity and structure what these countermeasures do particular references in the cybersecurity literature. Numerous to meet these needs, we reviewed prominent knowledge bases sources of research and development literature were analyzed, discussed in section II. Furthermore, no framework or model including a targeted sample of over 500 countermeasure patents exists that has had its knowledge content sustained at the rate drawnfromtheU.S.PatentOfficecorpusovertheyears2001to 2018. To demonstrate the value of this approach in practice, we of change in the cybersecurity space. D3FEND™ establishes describe how the graph supports queries that can inferentially afine-grainedsemanticmodelofcountermeasures,theirprop- map cybersecurity countermeasures to offensive TTPs. As part erties,relationships,andhistoryofdevelopment.Wehavealso of a larger vision, we outline future D3FEND work to leverage definedasemanticmodelofaportionofMITRE’sATT&CK® the linked open data available on research literature and apply framework[15]torepresenttheoffensiveTTPswiththesame machinelearning,inparticularsemi-supervisedmethods,toassist inmaintainingtheD3FENDknowledgegraphovertime.Finally, common, standardized semantic language (OWL DL). This we welcome community feedback on D3FEND. enables us to incorporate ATT&CK by mapping its concepts Index Terms—countermeasures, cybersecurity, cyber defense, directly to D3FEND’s model of defensive techniques and ar- intrusion detection, knowledge acquisition, knowledge engineer- tifacts. D3FEND provides a methodology for curating content ing, knowledge graph, linked data, network security, ontology, into new knowledge and tying it to its source information in procedures, tactics, techniques, TTPs meaningful ways. Finally, this paper provides a research road map for harvesting and analyzing content at the industry’s I. INTRODUCTION pace, using and extending the promising human language The cybersecurity defense market comprises more than technologies and semi-supervised learning. 5,000 companies [1]. More than 6,000 cybersecurity patent D3FEND’s longer-term goals are to (1) create a sustain- applications were filed in 2018 (Figure 1). Cyber defense able knowledge framework for characterizing and relating teams also implement their own countermeasures to address cybersecurity countermeasure technology; and (2) accelerate what vendor products do not. These custom capabilities are knowledge discovery and acquisition efforts required to keep often shared through open-source software communities. In a pace with technological changes in the cyber domain. The cycle of adaptation, countermeasures are rapidly developed in D3FEND knowledge graph we have constructed can be di- response to rapidly changing offensive techniques. rectly embedded within the much larger web of datasets available within the Linked Open Data Cloud [41]. These FundedbytheUnitedStatesDepartmentofDefense.ApprovedforPublic will be used to connect our knowledge to research literature, Release;DistributionUnlimited.Case20-2034.Copyright2021TheMITRE Corporation.AllRightsReserved. organizations, authors, inventors, and investors. We believe the representation chosen also provides a strong foundation (.govCAR) frameworks serve as threat-based tools for high- forresearchfurtheringautomation,includingmachine-learning level characterization of cyber threats and mitigations, and a approaches. means to identify gaps in cyber portfolios and architectures This paper explains how we collected and analyzed data to [12]. The Office of the Director of National Intelligence has produce the initial version of the model. In the following sec- created the Cyber Threat Framework to serve as a shared tions we discuss related work, our methodology, the resulting lexicon to characterize and categorize cyber threat events knowledge graph of countermeasure techniques, and finally [13]. The National Security Agency’s Technical Cyber Threat our roadmap for future work. Framework added extensive technical detail [14]. MITRE’s ATT&CK has influenced and been influenced by these frame- II. RELATEDWORK works. Related prior work includes early cybersecurity standards C. ATT&CK and formats, government and commercial cybersecurity threat frameworks and knowledge bases, commercial product tax- In “Finding Cyber Threats with ATT&CK-Based Analyt- onomies, and formal information modeling in cybersecurity ics,” MITRE created an analytic development methodology and other domains. focused on detecting post-compromise adversary behaviors [15]. This revolutionized the language security practitioners A. MITRE-initiated Cybersecurity Standards and Formats use to discuss their work. Vendors began to describe what Over the past two decades, MITRE has developed standard specificadversarybehaviorstheirproductswereabletodetect, languages and formats to capture cybersecurity information: prevent, or monitor. ATT&CK primarily modeled adversary CommonVulnerabilitiesandExposures(CVE®)[2],Common behavior via offensive techniques organized by the tactical Weakness Enumeration (CWE™) [3], Open Vulnerability and objectivestheysupport.ATT&CKhassinceamassedanonline Assessment Language (OVAL®) [4], Common Platform Enu- knowledge base of threat actor techniques [17]. meration (CPE™) [5], Common Event Expression (CEE™) ATT&CK™ knowledge (also encoded via STIX) is an [6], Common Attack Pattern Enumeration and Classification especially critical counterpart to D3FEND. D3FEND focuses (CAPEC™) [7], Malware Attribute Enumeration and Charac- on countermeasures. The two can be related as explained in terization (MAEC™) [8], and Cyber Observables (CybOX™) section IV-E. [9] languages. These shared vocabularies and disambiguating The Cyber Analytics Repository (CAR) was a key product references are useful for cybersecurity practitioners to record of MITRE’s ATT&CK work. CAR identifies objects related and exchange cyber threat knowledge. CybOX, MAEC, and to key operating system and processing events [18] with its CAPEC introduced more taxonomic and relational informa- CARDataModel,italsocatalogsMITREdevelopedanalytics tion;theirelementshavebeenincorporatedintotheStructured and maps them to specific ATT&CK techniques they were Threat Information eXpression (STIX™) OASIS™ standard designed to detect. The initial D3FEND release incorporates for Cyber Threat Intelligence (CTI). Together these provide theCARanalyticsdeveloped,butwhereasCARmodeleddata references on which we build a detailed, explicit model of from endpoint telemetry software and the associated analytics countermeasures. from a Security Operations Center Operator’s perspective, D3FEND models the countermeasure space from a hard- B. Cybersecurity Threat Frameworks wareorsoftwareengineer’sperspective.Therefore,D3FEND’s TheNationalInstituteofStandardsandTechnology(NIST) scope is limited only by the scope of the cybersecurity created and updates the Cybersecurity Framework, which technology space. provides security guidance for organizations to align their D. Commercial Product Taxonomies cybersecurity activities to manage their cybersecurity risk around an Identify-Protect-Detect-Respond-Recover paradigm Commercial product taxonomies tend to organize by form- [10]. This paradigm is broader than the kill-chain models we factor or intended buyer rather than function. This is useful discuss next, but it is focused on activity and organization for understanding which vendors might be relevant but does rather than engineering or technology. NIST also maintains not explain in enough detail how the products work or what the National Vulnerability Database, the U.S. government they do. However, there are implicit sets of features or func- repository of standards-based vulnerability management data tions that each grouping represents. Cybersecurity marketing for security controls enumerated in NIST 800-53 [11]. NIST vocabulary changes at such a pace that analyst firms produce maps these relevant security controls to the activities defined newtaxonomieseachyeardespiteonlymodestchangesinthe in the Cybersecurity Framework. underlying technical functionality [19]. Kill-chain oriented and derived threat models have proved Patent systems also provide taxonomies of technological popular and effective. New models like D3FEND must relate innovation and assign one or more of these codes to individ- to these to ensure rapid uptake by the cyber community and ual patents. The International Patent Classification system of easyintegrationwithexistingresources.TheU.S.Department 70,000 codes, and its extension, the Cooperative Patent Clas- of Defense Cyber Analysis and Review and U.S. Department sification system, are used to curate patents and are managed of Homeland Security Cybersecurity Architecture Review by the European and U.S. patent offices. In the cybersecurity domain, the categories are often broad and only taxonomical; sciences, and bioinformatics communities in cataloging and theydonotdescribekeyattributesofthetechnologiesdetailed deeply understanding complex patterns in medical datasets in the patents. and genomes. Scientists can now rapidly share knowledge andcollaborateoncomplexchemicalandproteininteractions. E. Formal Modeling of Cybersecurity Domain Knowledge The Unified Medical Language System [27] has integrated There have been many efforts to model the cybersecurity 213 medical vocabularies [28]. Bioinformatics researchers domainformallyandcreateknowledgerepresentationsforex- can leverage and tie together knowledge contained in The changeandsharedunderstanding.In2007,Herzog,Shamehri, EuropeanMolecularBiologyLaboratoryandEuropeanBioin- and Duma created a detailed model of information security, formatics Institute’s open data resources and The Universal including threat, asset, and countermeasure classes and rela- Protein Resource, which contains protein sequence and anno- tionships among them [20]. Fenz, Pruckner, and Manutscheri tation data. built on this by creating guidelines for mapping information TheSchema.orgvocabulary[29]isanopendatacommunity security knowledge from one standard to a more formal secu- founded by Google, Microsoft, Yahoo, and Yandex. The rity model [21]. Wang and Guo created a formal knowledge schema has been developed through a community process. model to capture key relationships between vulnerabilities, Schema.org builds on semantic web concepts and facilitates products, countermeasures, and actors—incorporating CVE, data exchanges and a shared understanding between sites the Common Vulnerability Scoring System, CWE, CPE, and choosingtosharestructuredsocialdataandaggregatorsofthat CAPEC—to describe patterns of threats and vulnerability social data. Google uses schema.org types for its Knowledge management to make inferences and assist users in decision Graph Search API [30]. Thomson Reuters is investing in this making [22]. technology as well, creating and spinning off a knowledge In 2012, MITRE reported on a trade study performed graph group for financial data [31] and news content. with the goal of creating a general cyber knowledge model ImmediatelyrelevanttotheD3FENDknowledgegraphand and method for extending its core over a series of iterative methodology are pre-existing open linked data resources. We improvements [23]. This team focused their initial work on seeopportunitiestorapidlyintegratepertinentopenlinkeddata buildingamodelfromtheMAEClanguageandpriormalware readilyavailable,includingpatentdata(andpatentcodingsys- conceptualmodelsofSwimmer,whichweredevelopedforthe tems), authors, researchers, inventors, and organizations. We purpose of data exchange between security software products. believe D3FEND may be enhanced by using and referencing From this, Obrst et al provide a vision for a much broader these open linked datasets with standards-based linked data cyber knowledge architecture and provide a useful survey technologies. of cyber-related knowledge representations and standards to III. METHODOLOGY contextualize their work and the architecture. A. Frameworks, Models, and Knowledge Graphs Oltramari et al. created a basic architecture with the key elements and interactions to support situational awareness Therearethreekeyinformationorganizationapproacheswe in the cybersecurity domain and then provided a modeling use to create D3FEND. A conceptual framework which “ex- example using their approach [24]. Salem et al. created the plains, either graphically or in narrative form, the main things TAPIOtool,whichextractsoperationaldataandintegratesdata to be studied—the key factors, constructs, or variables—and from numerous sources into a knowledge graph and enables the presumed relationships among them” [32]. A domain real-time exploration of the causes and effects of cyber events knowledge model which “is used to reduce conceptual and [25]. terminologicalconfusion”andfostercommunication,reusabil- Syed et al. created the Unified Cybersecurity Ontology ity, and cooperation [33]. Finally, a knowledge graph which (UCO) model by integrating several existing knowledge provides a flexible representation of knowledge and enables schemas and standards into a common model for the cyber- complex machine reasoning about the domain. security domain; like Oltramari et al, their model supports To support the recurring need for effective and clear coun- cybersituational-awarenessscenarios[26].In2019,theCyber- termeasurecapabilityspecifications,weaspireto(1)providea investigation Analysis Standard Expression (CASE) commu- conceptual framework that incorporates a domain knowledge nity was formed to coordinate a community-developed spec- model of the cyber countermeasure domain, (2) populate the ification language to “serve the broadest range of interests in frameworkandmodeltocompleteaknowledgegraph,and(3) cyber-investigationdomainsincluding:digitalforensicscience, relatecountermeasurestotheATT&CKframework’soffensive incident response, counter-terrorism, criminal justice, forensic counterpartsandtothelargerdomainspaceofstructuredcyber intelligence,andsituationalawareness.”CASEalignswithand knowledge. extends the UCO. D3FENDmodelscorecountermeasurefunctionalityandthe knowledge relationships necessary to effectively understand F. Successes Using Knowledge Graphs and Linked Data andcontextualizethatfunctionality.Countermeasuretechnolo- Recent advances in knowledge modeling and linked data gies perform many functions with their software or hardware technology have enabled its adoption in several domains. The components.Somefunctionsdirectlycounteradversarybehav- technology has proven fundamental to the medical, biological ior. Others are more administrative in nature and supportive Fig.1. CybersecurityPatentApplications2001-2018 Fig.2. ExampleIntellectualPropertyDevelopmentNetwork ofthecorecountermeasurefunctionalityandarenotthefocus of D3FEND. marketing material do not sufficiently explain how the tech- D3FEND is primarily concerned with abstract and generic nologies work at an engineering level, nor do they do so in semantics versus vendor specific terminology or technical jar- as uniform a manner as patents. To date, there appears to be gon. However, analysis of technical jargon is usually required no comprehensive public analysis of the cybersecurity patent to select effective semantics—and in some cases create or corpus for the purpose of developing a knowledge graph of define useful new semantics. For example, for D3FEND we cyber countermeasures. first included an abstract definition of a Kernel instead of This corpus, while useful, has numerous issues that need to the Microsoft terminology: “Windows Kernel” or “Windows be understood when using it for our purpose. In some cases, NT Kernel”, thereby enabling our Kernel concept to apply to the corpus is adversarial. For example, in academic papers, the “Linux Kernel” as well. When needed, D3FEND users the citations tend to have high fidelity because researchers will be able to extend this with more specific definitions of are incentivized to accurately represent prior scientific knowl- kernel types by subclassing specific OS kernels and also by edge. Patents also have citations and prior art enumerations. compositions of their parts (e.g, ”Kernel Module” elements). However, these are often selected to bolster the case that the newpatentistrulynovel,useful,andnon-obviousforbusiness B. Data Sources purposes. This is done without the peer review process used The data used to build D3FEND underpins our new ap- in academia. proach to systematically understanding cybersecurity counter- Forty percent of U.S. patented inventions are not used. measures. The research team developed the model directly About half of these are patents meant to block competitors or from the research claims in the literature in a bottom-up to be used as bargaining chips in inter-firm negotiations [36]. fashion,linkingeachcountermeasurethroughspecificcitations Our study catalogs all cyber-defense approaches, whether yet totheliteratureandintegratingthoseintohigher-levelabstrac- practiced or not; use of the D3FEND knowledge graph may tions.Wediscusspatents,existingknowledgebases,andother identify an unpracticed approach and encourage innovation data sources. and productization in that category. Furthermore, because our 1) Patents: Inventors file thousands of patent applications survey focuses on recent inventions in an emergent field, the each year for technologies and methods for defensive cyber- “not used” distinction is ephemeral in many instances. security techniques. We downloaded all U.S. Patent Office 2) Existing Knowledge Bases: We analyzed the MITRE filings from 2001 to January 2019. A key phrase search CyberAnalyticRepository[34]andmappeditsanalyticstothe against this corpus1 shows an ever-increasing publishing rate alpha version of D3FEND. The repository primarily contains on cybersecurity patents in Figure 1. detection analytics that consume endpoint telemetry. We also The patent corpus was our initial focus for multiple rea- analyzed the ATT&CK knowledge base and developed a way sons. There is strong motivation for inventors, investors, and to relate it to D3FEND, as discussed in Section IV-E. organizations to describe and distinguish how their cyberse- 3) Other Data Sources: We have also analyzed other data curity technologies work in patents. This due to the various sources.Someofthesesourcesincludeacademicpapers,tech- protections patents provide for intellectual property owners. It nical specifications, and publicly available product technical is also a highly curated corpus with category codes, citations, documentation. and an official legally-authoritative assessment of the novelty 4) Key Findings: After reviewing these data sources, we of their claims. In our experience, vendor white papers and determinedthattheseavailableintellectualpropertydocuments could serve as the foundation for a cybersecurity countermea- 1ApacheSolrsearchterms:”informationassurance””cybersecurity””cy- bersecurity” ”infosec” ”information security” ”network security” ”computer sure knowledge graph. We also were hopeful the resulting security” ”computer network defense” ”network defense” ”malware” ”com- knowledge graph would be coherent and useful to cybersecu- puter hacking” ”computer virus” ”data exfiltration” ”cyber warfare” ”infor- rityarchitects.TheD3FENDknowledgegraphwasbuiltfrom mation warfare” ”intrusion detection” ”intrusion prevention” ”indicators of compromise””securityinformationevents””cryptographic””cryptography” the patent corpus primarily due to its scope, specificity, and availability. These data sources are published or made public Taxonomy, 2019 [19] and analyzed their patents. Some of in various formats and venues. The cybersecurity community these technologies do more than just detect unauthorized has a diverse group of participants ranging from technicians activity. We incorporated these additional techniques and cat- to academics. Intellectual property is developed by the whole egorized them in the D3FEND knowledge graph. spectrum of participants. Example data sources are depicted Weapproachedtheproblemwithafocusoncountermeasure inFigure2.Thefigurealsoillustratestheintellectualproperty activity. We drew on two related systems engineering ap- development network which produces cybersecurity counter- proaches to describing and understanding system activity: ac- measure technology. We also determined these datasets are tivity models [38] [39] and uses cases [40]. These approaches too large to analyze entirely manually. However, we started helped us frame two related sets of questions to capture the with a manual analysis process so that we can better develop key aspects of the intellectual property when examining it in automated means. terms of being a defensive technique. The first set aimed to capture the core functional activity, and a second set captured C. Countermeasure Analysis Process key user interaction aspects. Both sets are shown in Table I. Our initial approach included some preliminary efforts Giventhevolumeofcybersecuritydataandpotentialdemands to use natural language processing techniques to organize, for users to stay in or on the decision loops (i.e., monitor summarize,andclassifythetechnologiesclaimedinthedocu- and handle system alerts), we placed a particular emphasis on ments, primarily U.S. patent applications. We experimented scaling concerns, both in implementing the basic capability with unsupervised topic modeling and text summarization and consequent user interactions. algorithms. We determined these preliminary methods were notsufficienttocreateasemanticrepresentationthatwouldbe useful to cybersecurity practitioners at the outset. Supervised TABLEI and semi-supervised machine-learning approaches were not TECHNIQUEELICITATIONQUESTIONS tried, as we did not yet have a countermeasure or artifact Howdoesthetechnologywork? Activitymodelelement classification system or a set of fixed terms and thus were Whatarethedatainputs? ActivityInput unable to provide labeled training data. Whatarethedataoutputs? ActivityOutput Ourearlyeffortstouseexistinghigh-levelmodelsandwork Whendoestheanalysisoccur? ActivityControl top down to specific countermeasures, or to propose our own Whataretheanalyticalalgorithms? ActivityMechanism Howdoesitworkatscale? ActivityMechanism high-level models absent the enumeration of countermeasure Howcanitbecircumvented? ActivityMechanism instances, did not prove to be an effective approach to create How do humans interact with the tech- Activitymodelelement the desired framework of concepts and vocabulary. Our ex- nology? perience is that without anchoring the framework to specific Whatmustthehumanuserdo? UserResponsibilities Howdoesthisinteractionscale? User-SystemRelationship instances from the outset, establishing team consensus for the vocabulary was difficult and was considered too subjective Theteamquicklyrealizedthatthiswastootimeconsuming, and too biased toward individual contributor’s experience and andinmanycasesitwasnotpossibletoanswereveryquestion background. Given this experience, we focused on describing for each intellectual property document. Additionally, many specific technologies and built up a hierarchy of semantic technologies solved multiple problems, i.e., they contained abstractionswhicharedirectlylinkedtotheoriginalreferences multiple D3FEND techniques. We then improved our process to enhance the fidelity of the knowledge graph. with a new approach. With a mindset towards automation, we began to manually analyze, summarize, and formulate semantics that describe We noticed that data input types to the technologies were the defensive techniques contained in the intellectual property a key factor in understanding how the technology works and documents. We then recorded the analyses in our database, anchoringthemtodefensivetechniques.PriorworkbyMITRE creatinganewlabeleddataset.Thisresultedinadatabasewith focused analytic development around an object enumeration, a vocabulary of countermeasure techniques, and references though the scope of the enumeration was focused on process to source documents where the concepts are described. This objects rather than the entire countermeasure space [18]. This process relied on our subject matter expertise and was labor led us to create the D3FEND Digital Artifact Ontology to intensive but necessary to develop an initial semantic model definethesedatainputtypeswithahigherdegreeofspecificity. ofthecountermeasurespace.Inaddition,weplantousethese This concept is further discussed in section IV-E. analyses to research training algorithms to both refine the Theknowledgeandfactsextractedduringtheseanalysesare initial model and expedite the development and recognition recorded in the D3FEND knowledge graph; where possible of new countermeasure techniques. we answered some of these initial questions for particular The team reviewed over 500 cybersecurity patents selected technologies or D3FEND techniques. The current knowledge basedonmultiplecriteria,andanalyzedthosewithsubstantial graph is alpha level; we are adding features and information technical detail. We initially focused on “detection” oriented necessary to be useful to a public audience. Our road-map vendorsbecausetheteamhadfamiliaritywiththedomain.We section explains our plan for developing a feature–complete chose vendors from IDC’s Worldwide Cybersecurity Products beta release. Fig.3. D3FENDKnowledgeGraphUserInterface:TacticsandTechniquesOverview IV. THED3FENDMODEL With our methodology we analyzed how defensive cyber- security technologies work. Semantic patterns and structure begantoemergeonceacriticalmassoftechnologieshadbeen analyzed. We then organized and refined this structure as our knowledge increased. “D3FEND” refers to all of D3FEND’s components: the knowledge graph, knowledge graph user interface, and the knowledge model. A. Structural Overview The D3FEND knowledge graph user interface, Figure 3, renders defensive tactics and techniques in a tabular view that also accounts for hierarchy. This view of the model is represented as a directed, acyclic graph. Each element links tomoredetailedinformation.TheD3FENDknowledgemodel Fig.4. D3FENDCoreKnowledgeModel has a few key top-level concepts, shown in Figure 4. The hi- erarchyofclassesisshownasgoldarrows,whilefundamental relationshipsbetweenthesecoreconceptsaredepictedasblue lines.Thiscoreisusedtoarrangetheinstancesofconceptsand organize the relational assertions that make up the D3FEND knowledge graph. tual model (i.e. knowledge model) to the particular facts. It is TheD3FENDknowledgegraph,currentlybeingdeveloped, a graph structure that represents instances, their relationships, isaparticulartypeofknowledgebase.Itconnectstheconcep- and their types. approaches to verification were different. It was apparent there may be advantages and disadvantages to the different approaches.Despitethesignificantdifferences,thesetechnolo- gies were designed to solve the same problem: verify that the codesegments(alsoknownastextsegments—Figure5)within a running process were as expected. To accurately make claims that a product implements a given technique, we must understand the technique’s seman- tics. We define the term process code segment to mean the portionsofmemoryassignedtoarunningprocessthatcontain machine code for execution. These code segments are usually loaded from disk when the application is executed to launch the process. By specifying process code segment we explain thatthistechniqueisnotconcernedwiththeapplicationimage on disk but its state once it is loaded into the memory of a Fig.5. Code(text)SegmentsandProcessMemoryLayout[37] launched process. Verification suggests that we are not only concerned with the integrity of the code segment but that B. D3FEND Technique Semantics a source of truth exists to verify against. This technique A D3FEND technique is the central and most important name is rooted in the computer science domain; the term concept in the D3FEND knowledge model. They are curated code segment is used in many computer science textbooks by D3FEND technique researchers. Cybersecurity technolo- to describe the machine code portions of an executable file. gies can be complex and may comprise multiple D3FEND Additional research is required to objectively quantify the techniques. Semantically, a D3FEND technique is represented quality of technique names. as a concise phrase that captures significant information. This Now that we have vocabulary for understanding a specific is difficult to do because it is a high-dimensional optimization D3FEND technique, we can ask the vendor key questions: problem. Under what circumstances does your technology read and Terms are selected for maximum information and minimal verify the process code segments? What is the source of truth confusion. Cybersecurity is a multi-disciplinary field; this used in the verification of the code segments; is it on the requires the technique researcher to be competent in not only victimmachineoraremotesystem?Whathappensifthecode the primary cybersecurity domain but also adjacent domains segments are determined to be invalid? The answers to these such as computer science and architecture, data analytics, questions were interesting and illustrated the creativity and social sciences, and information technology architecture. The cleverness of the cybersecurity technology developers. D3FEND technique researcher must anticipate the potentially This knowledge, intellectual property references, and anal- numerous interpretations that people of different technical ysis were recorded in our D3FEND knowledge graph under backgrounds may have and then select optimal, accurate, and the technique Process Code Segment Verification. With this precise terms. In general, the semantic context of computer informationorganizedandtheintellectualpropertycatalogued, science and computer engineering domains takes precedence practitioners are now able not only to understand how the over other domains. technique works but also to consider which approach is more suitable to their unique requirements. C. Example Technique: Process Code Segment Verification Our example—process code segment verification— To better explain the core concepts used in D3FEND, illustrates positioning within two key dimensions of semantic we will discuss an example D3FEND technique—process specificity, Figure 6. The level of specificity required for code segment verification—that was discovered through our describing functionality is dependent on usage context. development process. Here we will explain why those words Our taxonomical approach accommodates various levels of werechosen,whattheymean,andwhattheyandtheresulting specificity. This enables the model to be easily tailored to a knowledge graph entries enable the user to do. particular use case. For example, an acquisition analyst may Using our methodology, we identified and analyzed hun- require more generalization, while an engineer may require dredsofpiecesofpubliclydisclosedintellectualpropertyfrom more specificity. various cybersecurity vendors to extract D3FEND techniques. D. D3FEND Tactics & Techniques Webegantogroupanddescribethesetechniquessemantically. In the case of process code segment verification, we deter- As we developed techniques in the D3FEND knowledge minedseveralvendorsweretryingtosolvethesametechnical graph, we identified sets of similar techniques that had com- problem in very different ways. These technologies were mon relationships. For example, some techniques primarily developed over two decades and deployed in radically dif- analyze raw network traffic, while others focus purely on ferent form-factors ranging from endpoint software agents to process analysis. These techniques then naturally grouped software compiler technologies. Additionally, their analytical together further to organize more general types of techniques. Fig.7. OffensiveandDefensiveTechniquesMappingViaDigitalArtifacts digital object becomes a digital artifact when a cyber actor, either defensive or offensive, interacts with the object in any way. To ensure a reasonable modeling scope, the D3FEND knowledgemodelisonlyconcernedwithcapturingknowledge about digital artifacts relevant to known cyber actors and Fig.6. KeyDimensionsofSemanticSpecificity known technologies—not all possible digital objects or their representations. Related work in the field developed vocabularies to list and We distinguish the top-level techniques as base techniques, define common concepts used in cyber defense operations. from which all the other techniques are derived. For example, Somelimitationsofthesevocabulariesmotivatedtheconstruc- thetechniqueprocesscodesegmentverificationfallsunderthe tion of the D3FEND DAO, as these vocabularies were often base technique “Process Analysis.” syntactic rather than semantic, included vendor specific con- Aswegroupedthetechniques,weidentifiedanotherhigher- cepts,andwereenumerativeversustaxonomical.Furthermore, level concept, the defensive tactic. A defensive tactic is the these vocabularies did not specify the relationships between most general organizing class in the D3FEND knowledge concepts. Finally, their purview was security operations and graph; see Figure 4. A defensive tactic is a maneuver in incident response versus capability engineering. Therefore, it response to some adversary action. These are action-oriented was necessary to develop the D3FEND DAO as more abstract andcarefullyselectedtermstogeneralizemultipletechniques. semantic constructs, to unify the representation and enable Example defensive tactics we identified are Detect, Harden, vendor-agnostic and inferential reasoning. Deceive, Evict, and Isolate. The term artifact was chosen in the archaeological sense The tactics are represented in the top row, and the base (e.g., some human put some artifact somewhere). If it does techniques are represented in the second row of Figure 3. not exist in some form within some computer or computer More specific defensive techniques appear in the columns network infrastructure, it is out of scope of the ontology. A belowthebasetechniques.Techniquesbelongtoonlyonebase digitalartifactneednotbeobservableoraccessible,butitmust technique; in general, techniques form a hierarchy from the possibly exist. An artifact may also comprise other artifacts, most general to the most specific. For clarity, only two levels thus enabling the representation of compound artifacts; see of the defensive technique hierarchy are depicted in Figure 3. Figure 8. Finally, the circled number in the individual techniques rep- resents the number of source documents analyzed to develop Digital artifacts also establish the conceptual scope of the the technique. D3FEND knowledge model. For example, a strong password An implicit notion of state is expressed in terms chosen policy is in scope because it directly affects an organization’s for tactics. A defender cannot Evict an adversary if he cannot technology configuration baseline, therefore it involves digital Detect the adversary, and he cannot Detect the adversary if artifacts. As a counter-example, many organizations invest in they are not there. Ideally, the defender would Harden his employeecybersecurityawarenesstrainingprograms.Training environment before the adversary penetrates it. programs do not directly interact with digital artifacts, there- Tactics are the maneuvers defenders take against an fore they are not in scope. adversary—“the what” of an action. The techniques are the Whenanattackertypesonhiskeyboardandperformsopen- methods used to employ those actions—“the how” of imple- sourceinternetresearch,heproducesdigitalartifacts.Whenhe menting the tactic. We say that these tactics are enabled by develops software exploits, sends malicious phishing links, or the techniques. operatesaremotelycontrolledhostinhistarget’senvironment, he creates digital artifacts on both his system, intermediate E. Digital Objects, Digital Artifacts, and Technique Mapping systems, and target systems. Whether the defensive actors can A key construct in D3FEND is the Digital Artifact Ontol- observetheattacker’sdigitalartifactsdependsontheirvantage ogy (DAO). This ontology specifies the concepts necessary point and capabilities. Figure 7 illustrates these interactions to classify and represent the digital objects of interest for between offensive and defensive techniques in a simplified cybersecurity analysis. In the D3FEND knowledge model, a way. Fig.8. MappingviaInferenceThroughtheDigitalArtifactOntology Thecybersecurityanalystneedstoknowhowcyberoffense V. ROADMAP iscoveredbycyberdefenseandviceversa.Therefore,weneed There are three roadmap focus areas for the D3FEND a reasonable mechanism to specify in detail the associations project: improve and demonstrate the model utility for practi- between these two. Our approach focuses on using the digital tioners,deepenandwidenthemodelviaanalytics,andupdate artifacts as the basis for conceptualizing and instantiating the model as the industry changes. the relations. Both offensive and defensive techniques are associated with digital artifacts, where associated with is A. Model Utility a generic relationship type for more specific relationships Semantic models are most useful when they are adopted; of produces, executes, analyzes, accesses, and installs. The they create a common language. We will use the model in D3FEND knowledge model supports more specific relation- real-world use cases with cybersecurity architects and engi- shiptypesbetweenoffensiveanddefensivetechniquesaswell, neers. Success of the model is practitioner adoption and a for example, observes, detects, and counters. The key benefit positiveconsensusonitsusefulnessacrossmultipleusecases. of this layered approach is that we can reason about the Garnering adoption will be an iterative process where we relationships between offensive and defensive techniques by employthemodel,qualitativelyassessitsusefulness,andmake analyzing how each technique is related to digital artifacts. improvements. This allows us to infer these specific types of relationships One assessment will use the model to differentiate and without needing to manually or directly relate offensive analyze cybersecurity products. Large organizations receive techniques to defensive techniques (Figure 8). Provided we many inbound requests from technology vendors. Our hope accurately represent knowledge about offensive techniques, is that D3FEND clarifies the specific functionality a product defensivetechniques,anddigitalartifacts—eachinisolation— offers and reduces the amount of time spent analyzing vendor we can accrete knowledge and derive additional knowledge marketing material. Another assessment will analyze a com- and insights through inference that otherwise would require puter network’s existing countermeasures and identify which explicit enumeration. defensive techniques are present. We will start by asking a cybersecurity architect what technologies they have related to the base techniques, as a breadth-first analysis. We hope this Artifacts are defined in hierarchical specificity via classifi- will identify any functionality gaps or overlap. cation, and their subsumption is represented by gold lines in Asweworkthroughtheusecases,wewilltrackhowmuch Figure8.Forexample,aLinuxservicedaemon’sconfiguration of the model was used and how many new techniques were fileisaserviceconfigurationfile,whichisaSystemConfigura- added.Ourhypothesisisthatsemanticreusewillincreaseover tion File, which is a Configuration File, which is a File—File time, eventually reducing the frequency of additions to the beingthehighest-orderandleastspecificconcept.Thisallows model. We expect to follow-up this preliminary paper shortly us to ascertain the artifacts with which a particular defensive with one that provides greater detail on the application of technique is associated, with as much specificity as possible, D3FENDtooneormorespecificcapabilityanalysisscenarios. while still maintaining the ability to ask general questions B. Model Depth, Breadth, and Technology Development like, “which defensive techniques are associated with files?” or more specific questions like “which defensive techniques We must analyze more intellectual property to grow the are associated with daemon configuration files?” knowledgegraph.Duetothesizeoftheever-growingdataset, we must automate portions of the analysis process. This re- ACKNOWLEDGMENT quiresasystemoftoolsthatcanassistinextractingknowledge, Thanks to fellow MITRE employees Greg Dunn, Chris finding new topics, and tracking old ones. We will explore Thorpe, Jay Vora, Maura Tennor, Joe Patrick, Drew Cannon, using the system to enable machine-learning algorithms to Chris Magrin, Matt Venhaus, Emily Hopkins, Zach Asher, process data in the knowledge graph and develop models Parker Garrison, Robert Heinemann, Dan Ellis, Steve Luke, to characterize the knowledge graph, and potentially new and Bonnie Martin for their contributions to this work. instancesofknowledge.Byautomaticallytaggingnewdatawe canexpeditethediscoveryofnewconceptsandterminologyin REFERENCES thecountermeasuresspace.Underpinningthis,wewilldevelop [1] CrunchbaseInc.,“Companies—Crunchbase”29October2019. a flexible knowledge graph architecture that ingests public [2] The MITRE Corporation, “Common Vulnerabilities and Exposures,” data, captures new knowledge, and supports sophisticated 1999. [3] TheMITRECorporation,“CommonWeaknessEnumeration,”1999. storage and retrieval mechanisms. [4] The MITRE Corporation, “Open Vulnerability and Assessment Lan- guage,”2002. C. Future Data Sources and the Intellectual Property Gener- [5] TheMITRECorporation,“CommonPlatformEnumeration,”2007. ation Network [6] TheMITRECorporation,“CommonEventExpression,”2007. [7] The MITRE Corporation, “Common Attack Pattern Enumeration and Intellectual property can be collected from many sources. Classification,”2007. [8] TheMITRECorporation,“MalwareAttributeEnumerationandCharac- We plan to estimate the potential relevance or value of the terization,”2011. intellectual property by creating a graph with vertices of [9] The MITRE Corporation, “Cyber Observable eXpression (CybOX™) actors (people, companies, investors), edges of relationships ArchiveWebsite,”2012. [10] NIST,“FrameworkforImprovingCriticalInfrastructureCybersecurity,” between them as seen in Figure 2, and weighting the edges April2018. with business or influence metrics. We anticipate applying [11] NIST, “NIST Special Publication 800–53 Revision 4: Security and the same methodology found in Section III that we used for Privacy Controls for Federal Information Systems and Organizations,” NIST,2015. analyzing patents to additional technical corpora, including [12] DepartmentofHomelandSecurity,“DoDCAR/.govCAR,”2018. academic papers, conference presentations, blog posts, and [13] J. Richberg, “A Common Cyber Threat Framework: A Foundation for engineering journals. These data sources will be reduced to Communication,”2018. [14] NSA Cybersecurity Operations, The Cybersecurity Products and Shar- text-based representations, to enable accelerated analysis with ing Division, “NSA/CSS Technical Cyber Threat Framework v2,” natural language processing techniques. NSA/CSS,FortMeade,MD,2019. [15] B. E. Strom, J. A. Battaglia, M. S. Kemmerer, W. Kupersanin, D. P. D. Updating the Model Miller,C.Wampler,S.M.Whitley,R.D.Wolf,“FindingCyberThreats withATT&CK™-BasedAnalytics,”2017. As illustrated by our analysis of the patent application [16] B. E. Strom, A. Applebaum, D. P. Miller, K. C. Nickels, A. G. Pennington, and C. B. Thomas, “MITRE ATT&CK™ Design and submissionrates,thereissignificantdynamismandactivityin Philosophy,”2018. thecybersecuritymarket.Asnewsourcesofpublicintellectual [17] TheMITRECorporation,“MITREATT&CK™,”30October2019. property are collected, they must be archived, processed, and [18] TheMITRECorporation,“CARDataModel,”30October2019. [19] InternationalDataCorporation,“IDC’sWorldwideCybersecurityProd- analyzed.Ourknowledgegraphtoolswilldiscovernewdigital uctsTaxonomy,2019,”2019. artifacts and new defensive techniques. These discoveries will [20] A. Herzog, N. Shamehri, and C. Duma, “An Ontology of Information be added to the D3FEND knowledge graph. Security,”inInternationalJournalofInformationSecurityandPrivacy, 2007. [21] S. Fenz, T. Pruckner, and A. Manutscheri, “Ontological Mapping of VI. CONCLUSION InformationSecurityBest-PracticeGuidelines,”inBusinessInformation Systems:12thInternationalConference,Poznan,Poland,2009. In D3FEND, we have created a precise semantic model [22] J. A. Wang and M. Guo, “OVM: An Ontology for Vulnerability of cybersecurity countermeasures that enables practitioners, Management,”inCSIIRW,OakRidge,Tennessee,2009. for the first time, to assess their defenses and fill gaps [23] L. Obrst, P. Chase, and R. Markeloff, “Developing an Ontology of the Cyber Security Domain,” in Semantic Technology for Intelligence, with engineering-level knowledge of technical capabilities. Defense,andSecurity(STIDS),Fairfax,Virginia,2012. The alpha version of D3FEND (Figure 3) received positive [24] A. Oltramari, L. F. Cranor, R. Walls, and P. McDaniel, “Building an feedback from MITRE cybersecurity experts. Successful use OntologyOfCyberSecurity,”inSTIDS,Fairfax,Virginia,2014. [25] M. B. Salem and C. Wacek, “Enabling New Technologies for Cyber in countermeasure requirements analysis is required to further Security Defense with the ICAS Cyber Security Ontology,” in STIDS, validate it. We were satisfied with the semantic consistency Fairfax,Virginia,2015. of it because it was easy to add new defensive techniques in [26] Z. Syed, A. Padia, T. Finin, L. Mathews, and A. Joshi, “UCO: A UnifiedCyberOntology,”inAAAIWorkshoponArtificialIntelligence a repeatable fashion. These initial results show good promise, forCybersecurity,Phoenix,Arizona,2016. and we believe our research has demonstrated the feasibility [27] O.Bodenreider,“UnifiedMedicalLanguageSystem(UMLS):integrat- ofacountermeasuremodelbuiltfromreal-worlddatasources. ingbiomedicalterminology,”NucleicAcidsRes.,vol.DB,no.32,pp. 267–270,23May2004. The next phase of work will focus on fully populating it [28] NIH, “UMLS Metathesaurus Vocabulary Documentation,” NIH U.S. with countermeasures and developing the tools necessary to NationalLibraryofMedicine,4November2018. ensure it stays up to date. Automation is required to deal with [29] Schema.orgCommunityGroup,“schema.org,”Schema.orgCommunity Group,2015. the rate of change in the domain and sustain the D3FEND [30] Google,“GoogleKnowledgeGraphSearchAPI,”Google,2019. countermeasure knowledge graph over time. [31] Refinitiv,“KnowledgeGraphfeedBETA,”2019. [32] M. B. Miles and A. M. Huberman, “Qualitative Data Analysis: An ExpandedSourcebook,”ThousandOaks,CA:SagePublications,1994. [33] M. Missikoff, P. Velardi, and P. Fabriani, “Text Mining Techniques to AutomaticallyEnrichaDomainOntology,”AppliedIntelligence,vol.3, no.18,pp.323–350,2003. [34] TheMITRECorporation,“MITRECyberAnalyticsRepository” [35] R.Bretnor,“DecisiveWarfare:AStudyinMilitaryTheory,”inDecisive Warfare:AStudyinMilitaryTheory(Newed.).,WildsidePressLLC., February1,2001,p.49–52. [36] P. Zuniga, D. Guellec, et al. “OECD patent statistics manual,” Paris: OECDPublications,2009 [37] Wikipedia contributors, “Organization of a program into segments,” Available: https://en.wikipedia.org/wiki/File:Program memory layout.pdf, November,2019. [38] D.Ross,“StructuredAnalysis:ALanguageforCommunicatingIdeas,” IEEE Transactions on Software Engineering 3(1), Special Issue on RequirementsAnalysis,January1977,16-34. [39] DefenseAcquisitionUniversityPress,”SystemEngineeringFundamen- tals,”FortBelvoir,VA,January,2001. [40] I. Jacobson, M. Christerson, P. Jonsson, and G. Overgaard, “Object- oriented software engineering - a use case driven approach,” Addison- Wesley1992,ISBN978-0-201-54435-0,pp.I-XX,1-524. [41] J. McCrae, “The Linked Open Data Cloud”, iod-cloud.net, https://iod- cloud.net,Accessedon:2020-08-25.